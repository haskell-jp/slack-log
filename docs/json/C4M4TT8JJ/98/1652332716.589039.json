[
    {
        "text": "VS Code の Haskell 拡張が HLS の管理をしてくれなくなったので ghcman にも HLS 管理機能を入れたい",
        "type": "message",
        "ts": "1652332716.589039",
        "user": "U4L0B71L1"
    },
    {
        "text": "VSCode の Haskell extension のバージョンを上げて、手許に ghcup を入れて設定しなおせば、ツールチェインも含めて管理してくれるようになりますが、これではだめですか？",
        "type": "message",
        "ts": "1652332765.399179",
        "user": "UK0MXUCAV"
    },
    {
        "text": "HLS の自動インストールには、GHC のバージョンとOS, arch の組合せ（そのハッシュ）を適切に管理する必要があったり、GHC 9.0.2 のようなイレギュラーな場合ビルドリビジョンに起因する ABI の違いなども吸収する必要があって（ここはまだ対応できてないですが）、結構デリケートなところがあるので、GHCup と HLS のチームは連携して作業を進めていたりします。",
        "type": "message",
        "ts": "1652333076.702729",
        "user": "UK0MXUCAV"
    },
    {
        "text": "VS Code 拡張くんは ghc-os-arch からどの HLS を使うかを ghcup 使って解決してるってことですかね\nふーむ",
        "type": "message",
        "ts": "1652333719.421829",
        "user": "U4L0B71L1"
    },
    {
        "text": "どちらかというと ghcup にその辺りの判別まで任せて自動で入れるようにさせている、という形ですね。設定によっては、HLS だけでなく stack のインストールとかも ghcup 経由でしてくれるようになってます。",
        "type": "message",
        "ts": "1652333810.585199",
        "user": "UK0MXUCAV"
    },
    {
        "text": "cabal ベースだったら GHC のインストールとかも自動でやってくれるんじゃなかったかな（初期設定でどこまでやってくれたかはちょっと覚えていないです",
        "type": "message",
        "ts": "1652333858.661209",
        "user": "UK0MXUCAV"
    },
    {
        "text": "動機としては、ふだん UNIX ツールチェーンを使ってない＆ghcup が Windows 非対応のころから自前管理してたという経緯で GHC がすでにマシンにあるのに ghcup 使うと別途インストールされるので、なんかやだなーという気持ちでした",
        "type": "message",
        "ts": "1652334061.500689",
        "user": "U4L0B71L1"
    },
    {
        "text": "なるほどー。stack とか使ってればそっちの ghc を使ってくれるので重複はないんですけど、自前管理だとちょっとつらそうですね。個人用途なら完全に決め打ちで持ってきてしまうとか、ghcup のリリース情報の YAML の情報だけ拝借して、そっからインストールするロジックは自前で書く（or ghcup から port する）とかがいいのかもしれません",
        "type": "message",
        "ts": "1652334150.860719",
        "user": "UK0MXUCAV"
    },
    {
        "text": "ghcup の作者の Julian はかなり密に ghc / HLS のチームと連絡をとりあっている（何せ ghcup は公式推奨のインストール方法になっているので）ので、その成果物のリリース情報のハッシュ値はけっこう信頼していいと思います",
        "type": "message",
        "ts": "1652334207.728259",
        "user": "UK0MXUCAV"
    },
    {
        "text": "ただ 9,0.2 は profile build まわりが欠けていて一部環境向けでは二回リリースが行われている都合上、ちょっとトリッキーなのでどのバイナリを使っているのかはちゃんと考慮する必要があったりしますが",
        "type": "message",
        "ts": "1652334268.737059",
        "user": "UK0MXUCAV"
    },
    {
        "text": "ghcup の metadata 群はここにあるみたいですね <https://github.com/haskell/ghcup-metadata>",
        "type": "message",
        "ts": "1652334373.025959",
        "user": "UK0MXUCAV"
    },
    {
        "text": "なんかポロっと書いただけなのに知見助かります",
        "type": "message",
        "ts": "1652334402.751389",
        "user": "U4L0B71L1"
    },
    {
        "text": "9.0.2、バッドノウハウすぎる……",
        "type": "message",
        "ts": "1652334863.051909",
        "user": "U4L0B71L1"
    }
]