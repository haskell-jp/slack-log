<!DOCTYPE html><html><head><meta charset="utf-8"><title>haskell-jp / questions #96</title><link rel="stylesheet" href="../../main.css" type="text/css" media="screen"></head><body><div class="ui container"><h1>haskell-jp / questions #96</h1><div class="pager ui pagination menu"><a href="../../html/C5666B6BB/96.html" class="pager__previous item">Previous</a><a href="../../" class="pager__top item">Top</a></div><div class="message_list ui feed"><div class="message event" id="message-1615540248.006100"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615540248.006100">2021-03-12&nbsp;18:10:48 +0900</a></div></div><div class="message__body description">@nekonistyle has joined the channel</div></div></div><div class="message event" id="message-1615570535.006300"><div class="content"><div class="summary"><div class="message__header user">sakoh10</div><div class="message__timestamp date"><a class="date" href="#message-1615570535.006300">2021-03-13&nbsp;02:35:35 +0900</a></div></div><div class="message__body description">@sakoh10 has joined the channel</div></div></div><div class="message event" id="message-1615609238.006700"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615609238.006700">2021-03-13&nbsp;13:20:38 +0900</a></div></div><div class="message__body description">質問はこちらの方が良いでしょうかね？</div></div></div><div class="message event" id="message-1615610001.014200"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615610001.014200">2021-03-13&nbsp;13:33:21 +0900</a></div></div><div class="message__body description">まず、Haskellというよりももっと一般的な質問なのですが、<br/>webアプリのバックエンドって、フロントから呼び出されるたびに起動して、データベースを読み込んだりするものなのでしょうか？<br/><br/>何がいいたいかというと、バックエンドでフロントから送られてきたデータを使ってリストを作りたいのですが、このリストは毎回データベースに保存しなければならないのか、それともバックエンドのプログラム内に保持しておくことができるのか、という質問です。</div></div></div><div class="message event" id="message-1615610091.015600"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615610091.015600">2021-03-13&nbsp;13:34:51 +0900</a></div></div><div class="message__body description">しかもHaskellでデータを保持するとはどういうことなのか（参照等価なので）もよく分かっていないです。</div></div></div><div class="message event" id="message-1615610103.016000"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615610103.016000">2021-03-13&nbsp;13:35:03 +0900</a></div></div><div class="message__body description">すみません、あまりうまく説明できないです...</div></div></div><div class="message event" id="message-1615610558.016300"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615610558.016300">2021-03-13&nbsp;13:42:38 +0900</a></div></div><div class="message__body description">やりたいことは、関数型言語Elmみたいな構造をバックエンドでもやりたくて以下の構造を作ってみたのですが、<br/>'sが状態の型<br/>'iが入力の型<br/>'oが出力の型<br/>で、バックエンドでやりたいのは、<br/>初期状態がinit::'sと<br/>状態state::'sと入力input::'iに対して、次の状態と出力を返す関数update::'s -&gt; 'i -&gt; 's,'oで定義できるのではと考えて、型を実装してみました。<br/><br/>問題はこの構造から具体的にデータベースへアクセスしたりJSONなどに変換したりする実装をどうするかというところで止まっています。</div></div></div><div class="message event" id="message-1615610619.017400"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615610619.017400">2021-03-13&nbsp;13:43:39 +0900</a></div></div><div class="message__body description">ちなみにこのコードは、形式検証をするために定理証明支援系Coqと呼ばれるもので記述したコードをHaskellのコードに変換したものになっています。</div></div></div><div class="message event" id="message-1615612695.020100"><div class="content"><div class="summary"><div class="message__header user">nekonistyle</div><div class="message__timestamp date"><a class="date" href="#message-1615612695.020100">2021-03-13&nbsp;14:18:15 +0900</a></div></div><div class="message__body description">理想としては、Architecture型の引数をもらって、それに応じてデータベースのやりとりとJSONの入出力を行ってくれる関数を定義したい感じです。<br/><br/>データベースから's型の変数を作り、入力のJSONを'i型に変換し、updateを施した後、返り値の's型のデータをデータベースに保存し、'o型の返り値をJSONに変換して出力。</div></div></div><div class="message event" id="message-1615735084.022300"><div class="content"><div class="summary"><div class="message__header user">forprivc</div><div class="message__timestamp date"><a class="date" href="#message-1615735084.022300">2021-03-15&nbsp;00:18:04 +0900</a></div></div><div class="message__body description">@forprivc has joined the channel</div></div></div><div class="message event" id="message-1615862877.000200"><div class="content"><div class="summary"><div class="message__header user">pyar6329_haskell</div><div class="message__timestamp date"><a class="date" href="#message-1615862877.000200">2021-03-16&nbsp;11:47:57 +0900</a></div></div><div class="message__body description">@pyar6329_haskell has joined the channel</div></div></div><div class="message event" id="message-1616317363.001400"><div class="content"><div class="summary"><div class="message__header user">matsubara0507</div><div class="message__timestamp date"><a class="date" href="#message-1616317363.001400">2021-03-21&nbsp;18:02:43 +0900</a></div></div><div class="message__body description">persistent 関連のテストを書いてるんですけど、なんかいい感じに <strike>モック</strike> テスト用データを作ったりできるテストライブラリってあるんですかね？<br/>Ruby (Rails) とかだと <a href='https://github.com/thoughtbot/factory_bot'>factory_bot</a> とかを使うんですけど、パッと探した感じ、そういうの見つかりませんでした。</div></div></div><div class="message event" id="message-1616399255.005500"><div class="content"><div class="summary"><div class="message__header user">ncaq</div><div class="message__timestamp date"><a class="date" href="#message-1616399255.005500">2021-03-22&nbsp;16:47:35 +0900</a></div></div><div class="message__body description">CloudWatch logのJSON形式で良い感じにログを出力させるOSSって既にありますか?<br/>[amazonka-cloudwatch-logs: Amazon CloudWatch Logs SDK.](<https://hackage.haskell.org/package/amazonka-cloudwatch-logs>)<br/>は出力するのではなく逆に出力を解析する方みたいで不適に見えます<br/>ちゃんとフォーマットするかはともかく作ること自体は簡単そうですが、車輪の再発明はしたくないなと思ったのです<br/>無いなら作ります</div></div></div><div class="message event" id="message-1616430017.009000"><div class="content"><div class="summary"><div class="message__header user">tsuhaso</div><div class="message__timestamp date"><a class="date" href="#message-1616430017.009000">2021-03-23&nbsp;01:20:17 +0900</a></div></div><div class="message__body description">@tsuhaso has joined the channel</div></div></div><div class="message event" id="message-1616568538.009300"><div class="content"><div class="summary"><div class="message__header user">plastic.velocity</div><div class="message__timestamp date"><a class="date" href="#message-1616568538.009300">2021-03-24&nbsp;15:48:58 +0900</a></div></div><div class="message__body description">@plastic.velocity has joined the channel</div></div></div><div class="message event" id="message-1616580232.009900"><div class="content"><div class="summary"><div class="message__header user">kakkun61</div><div class="message__timestamp date"><a class="date" href="#message-1616580232.009900">2021-03-24&nbsp;19:03:52 +0900</a></div></div><div class="message__body description">stack における下記のようなものって cabal にありますか？<br/><pre>stack ide targets</pre></div></div></div><div class="message event" id="message-1616685563.010700"><div class="content"><div class="summary"><div class="message__header user">wasabi.nvim.st</div><div class="message__timestamp date"><a class="date" href="#message-1616685563.010700">2021-03-26&nbsp;00:19:23 +0900</a></div></div><div class="message__body description"><code>fused-effects</code>を用いて`callCC`をサポートするEffectを作ろうとしているのですが<br/>実装がうまく行きません. どうすれば実装できるか知りたいです. 質問の詳細はスレッドに<br/>続きます.</div></div></div><div class="message event" id="message-1617033943.018800"><div class="content"><div class="summary"><div class="message__header user">cobodo</div><div class="message__timestamp date"><a class="date" href="#message-1617033943.018800">2021-03-30&nbsp;01:05:43 +0900</a></div></div><div class="message__body description">@cobodo has joined the channel</div></div></div><div class="message event" id="message-1617034812.019000"><div class="content"><div class="summary"><div class="message__header user">cle.neige</div><div class="message__timestamp date"><a class="date" href="#message-1617034812.019000">2021-03-30&nbsp;01:20:12 +0900</a></div></div><div class="message__body description">@cle.neige has joined the channel</div></div></div><div class="message event" id="message-1617262797.019600"><div class="content"><div class="summary"><div class="message__header user">sgt.yamauchi</div><div class="message__timestamp date"><a class="date" href="#message-1617262797.019600">2021-04-01&nbsp;16:39:57 +0900</a></div></div><div class="message__body description">@sgt.yamauchi has joined the channel</div></div></div><div class="message event" id="message-1617520312.022700"><div class="content"><div class="summary"><div class="message__header user">ken.aszw</div><div class="message__timestamp date"><a class="date" href="#message-1617520312.022700">2021-04-04&nbsp;16:11:52 +0900</a></div></div><div class="message__body description">@ken.aszw has joined the channel</div></div></div><div class="message event" id="message-1617945954.030600"><div class="content"><div class="summary"><div class="message__header user">yoshitomo4561105</div><div class="message__timestamp date"><a class="date" href="#message-1617945954.030600">2021-04-09&nbsp;14:25:54 +0900</a></div></div><div class="message__body description">@yoshitomo4561105 has joined the channel</div></div></div><div class="message event" id="message-1618213390.030800"><div class="content"><div class="summary"><div class="message__header user">muratomo.0205</div><div class="message__timestamp date"><a class="date" href="#message-1618213390.030800">2021-04-12&nbsp;16:43:10 +0900</a></div></div><div class="message__body description">@muratomo.0205 has joined the channel</div></div></div><div class="message event" id="message-1618213908.033500"><div class="content"><div class="summary"><div class="message__header user">muratomo.0205</div><div class="message__timestamp date"><a class="date" href="#message-1618213908.033500">2021-04-12&nbsp;16:51:48 +0900</a></div></div><div class="message__body description">はじめまして，本日参加させていただきました．いきなりですが質問失礼します．<br/>こちらと同じ機能をcaseを使って書くことはできるのでしょうか?</div></div></div><div class="message event" id="message-1618213973.033600"><div class="content"><div class="summary"><div class="message__header user">muratomo.0205</div><div class="message__timestamp date"><a class="date" href="#message-1618213973.033600">2021-04-12&nbsp;16:52:53 +0900</a></div></div><div class="message__body description"></div></div></div><div class="message event" id="message-1618214773.033800"><div class="content"><div class="summary"><div class="message__header user">muratomo.0205</div><div class="message__timestamp date"><a class="date" href="#message-1618214773.033800">2021-04-12&nbsp;17:06:13 +0900</a></div></div><div class="message__body description">すべて`x`でマッチしてガード式を使うというのは自分で思いつきました</div></div></div><div class="message event" id="message-1618242059.036000"><div class="content"><div class="summary"><div class="message__header user">benrbray</div><div class="message__timestamp date"><a class="date" href="#message-1618242059.036000">2021-04-13&nbsp;00:40:59 +0900</a></div></div><div class="message__body description">@benrbray has joined the channel</div></div></div><div class="message event" id="message-1618282578.036300"><div class="content"><div class="summary"><div class="message__header user">yasutakaodo</div><div class="message__timestamp date"><a class="date" href="#message-1618282578.036300">2021-04-13&nbsp;11:56:18 +0900</a></div></div><div class="message__body description">@yasutakaodo has joined the channel</div></div></div><div class="message event" id="message-1618539160.036900"><div class="content"><div class="summary"><div class="message__header user">kazu</div><div class="message__timestamp date"><a class="date" href="#message-1618539160.036900">2021-04-16&nbsp;11:12:40 +0900</a></div></div><div class="message__body description">cabal v1-test で起動されるテストの CWD は、パッケージのトップディレクトリでした。テスト中にファイルパスを書くとき、パッケージのトップディレクトリから相対パスを書けばOKでした。<br/><br/>cabal v2-test で起動されるテストの CWD は、パッケージのトップディレクトリではないようです。ファイルパスは、どうやって書くのが正しいでしょうか？ できれば、v1-test と共存できる方法が知りたいです。</div></div></div><div class="message event" id="message-1618609497.038000"><div class="content"><div class="summary"><div class="message__header user">s-takano</div><div class="message__timestamp date"><a class="date" href="#message-1618609497.038000">2021-04-17&nbsp;06:44:57 +0900</a></div></div><div class="message__body description">@s-takano has joined the channel</div></div></div><div class="message event" id="message-1618637380.047800"><div class="content"><div class="summary"><div class="message__header user">gettaplacetogo</div><div class="message__timestamp date"><a class="date" href="#message-1618637380.047800">2021-04-17&nbsp;14:29:40 +0900</a></div></div><div class="message__body description">前ここで質問させていただいた、<br/><a href='https://haskell-jp.slack.com/archives/C5666B6BB/p1594261873131500'>https://haskell-jp.slack.com/archives/C5666B6BB/p1594261873131500</a><br/>に関連するのですが、haskellのlayout付きコードをbraces and semicolonsに完全に変換するのって、自分で例のレポートのL関数を(悪名高いparse-error(t)含め)実装するしかないのでしょうか？ ghcの拡張をふんだんに使ったコードを変換するので、あんまり車輪の再発明はしたくなくて…</div></div></div><div class="message event" id="message-1618734832.054000"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1618734832.054000">2021-04-18&nbsp;17:33:52 +0900</a></div></div><div class="message__body description">ulidというパッケージについてrandom-1.2以降への対応を試みています<br/>（背景: <a href='https://zenn.dev/autotaker/articles/random-1-2-is-awesome'>https://zenn.dev/autotaker/articles/random-1-2-is-awesome</a> ）<br/>どなたか、できればCPP使って1.2より前のバージョンと1.2以後両方の対応をやったことがあれば修正例として参考にさせていただけないでしょうか？</div></div></div><div class="message event" id="message-1618819482.061300"><div class="content"><div class="summary"><div class="message__header user">sakaguchi</div><div class="message__timestamp date"><a class="date" href="#message-1618819482.061300">2021-04-19&nbsp;17:04:42 +0900</a></div></div><div class="message__body description">@sakaguchi has joined the channel</div></div></div><div class="message event" id="message-1618901141.068300"><div class="content"><div class="summary"><div class="message__header user">sakaguchi</div><div class="message__timestamp date"><a class="date" href="#message-1618901141.068300">2021-04-20&nbsp;15:45:41 +0900</a></div></div><div class="message__body description">こんにちは。GHC である計算 `act :: IO ()` を走らせたときに、それによってヒープ上に確保されたバイト数の総量（の近似）を知る方法をご存知の方がいたら教えてください。最初 `GHC.Stats` の `allocated_bytes` がそれかなと思っていたのですが、`act` を実行している間に勝手に GC が走らないように `+RTS -T -I0 -A8G -G1 -m1` を渡してみたところ、最初から 8GB の領域が確保された状態になり（従って `allocated_bytes` は 8 * 1024^3 になる？）、その中でどれだけのメモリが実際に使われているかが分かりません。 <https://hackage.haskell.org/package/base-4.15.0.0/docs/GHC-Stats.html></div></div></div><div class="message event" id="message-1618901594.068400"><div class="content"><div class="summary"><div class="message__header user">konn.jinro</div><div class="message__timestamp date"><a class="date" href="#message-1618901594.068400">2021-04-20&nbsp;15:53:14 +0900</a></div></div><div class="message__body description">関数呼び出しに対してヒープアロケーション量をはかる場合だと、ぼくはよく weigh を使いますね<br/><a href='https://hackage.haskell.org/package/weigh'>https://hackage.haskell.org/package/weigh</a></div></div></div><div class="message event" id="message-1619067613.071300"><div class="content"><div class="summary"><div class="message__header user">kazu</div><div class="message__timestamp date"><a class="date" href="#message-1619067613.071300">2021-04-22&nbsp;14:00:13 +0900</a></div></div><div class="message__body description"><code>bracket</code> の第二引数(資源解放)で STM を利用すると、デッドロックを起こすことがあるのは、よく知られたことですか？</div></div></div><div class="message event" id="message-1619319644.071700"><div class="content"><div class="summary"><div class="message__header user">U01UXJFJA95</div><div class="message__timestamp date"><a class="date" href="#message-1619319644.071700">2021-04-25&nbsp;12:00:44 +0900</a></div></div><div class="message__body description">@U01UXJFJA95 has joined the channel</div></div></div><div class="message event" id="message-1619331178.072300"><div class="content"><div class="summary"><div class="message__header user">hexirp</div><div class="message__timestamp date"><a class="date" href="#message-1619331178.072300">2021-04-25&nbsp;15:12:58 +0900</a></div></div><div class="message__body description">関数型プログラミング言語を作りたいので、グラフ簡約について勉強したいのですが、何かいい文献はありますか？</div></div></div></div><div class="pager ui pagination menu"><a href="../../html/C5666B6BB/96.html" class="pager__previous item">Previous</a><a href="../../" class="pager__top item">Top</a></div></div></body></html>