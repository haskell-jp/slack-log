<!DOCTYPE html><html><head><meta charset="utf-8"><title>haskell-jp / questions #34</title><link rel="stylesheet" href="/messages.css" type="text/css" media="screen"></head><body><h1>haskell-jp / questions #34</h1><div class="pager"><a href="/html/C5666B6BB/33.html" class="pager__previous">Previous</a><a href="/" class="pager__top">Top</a><a href="/html/C5666B6BB/35.html" class="pager__next">Next</a></div><div class="message_list"><div class="message" id="message-1546533160.027600"><div class="message__timestamp">2019-01-04<br/>01:32:40 +0900</div><div class="message__header">mic.ms.co</div><div class="message__body">@mic.ms.co has joined the channel</div></div><div class="message" id="message-1546568348.028000"><div class="message__timestamp">2019-01-04<br/>11:19:08 +0900</div><div class="message__header">kitada.kosuke</div><div class="message__body">@kitada.kosuke has joined the channel</div></div><div class="message" id="message-1546707765.028300"><div class="message__timestamp">2019-01-06<br/>02:02:45 +0900</div><div class="message__header">yethan.goes.asna</div><div class="message__body">@yethan.goes.asna has joined the channel</div></div><div class="message" id="message-1546877590.028800"><div class="message__timestamp">2019-01-08<br/>01:13:10 +0900</div><div class="message__header">oyasumi60</div><div class="message__body">@oyasumi60 has joined the channel</div></div><div class="message" id="message-1546885490.029100"><div class="message__timestamp">2019-01-08<br/>03:24:50 +0900</div><div class="message__header">fmr23s</div><div class="message__body">@fmr23s has joined the channel</div></div><div class="message" id="message-1546916871.029500"><div class="message__timestamp">2019-01-08<br/>12:07:51 +0900</div><div class="message__header">ghbjy6</div><div class="message__body">@ghbjy6 has joined the channel</div></div><div class="message" id="message-1546942393.029800"><div class="message__timestamp">2019-01-08<br/>19:13:13 +0900</div><div class="message__header">skazufumi.a02525</div><div class="message__body">@skazufumi.a02525 has joined the channel</div></div><div class="message" id="message-1546947112.030100"><div class="message__timestamp">2019-01-08<br/>20:31:52 +0900</div><div class="message__header">cgeb</div><div class="message__body">@cgeb has joined the channel</div></div><div class="message" id="message-1546952238.034700"><div class="message__timestamp">2019-01-08<br/>21:57:18 +0900</div><div class="message__header">hexirp</div><div class="message__body"><code>func f [1, 2, 3] [False, True] = [[f 1 False, f 1 True], [f 2 False, f 2 True], [f 3 False, f 3 True]]</code> みたいな関数 (`f &lt;$&gt; a &lt;*&gt; b` の平らにしないバージョン) を簡単に書く方法ってあります？ 今は fmap の繰り返しで書いてます</div></div><div class="message" id="message-1546952288.034800"><div class="message__timestamp">2019-01-08<br/>21:58:08 +0900</div><div class="message__header">hexirp</div><div class="message__body">あ、自己解決したかも。質問する前に思いつきたかった <code>func f a b = [ [ f as bs | as &lt;- a ] | bs &lt;- b ]</code></div></div><div class="message" id="message-1546953190.035300"><div class="message__timestamp">2019-01-08<br/>22:13:10 +0900</div><div class="message__header">hexirp</div><div class="message__body"><code>func f a b = [ [ f as bs | bs &lt;- b ] | as &lt;- a ]</code> でした</div></div><div class="message" id="message-1546954815.035600"><div class="message__timestamp">2019-01-08<br/>22:40:15 +0900</div><div class="message__header">hexirp</div><div class="message__body">as と a は逆です。なんか頭がバグってた</div></div><div class="message" id="message-1546962007.035800"><div class="message__timestamp">2019-01-09<br/>00:40:07 +0900</div><div class="message__header">yharuhi39</div><div class="message__body"><code>func f a = map (\y -&gt; map (\x -&gt; f x y) a)</code> とかまでは行けましたがそれから先はうーん。</div></div><div class="message" id="message-1546972136.047900"><div class="message__timestamp">2019-01-09<br/>03:28:56 +0900</div><div class="message__header">sugano</div><div class="message__body">はじめまして。packagename.cabalのないpackageを依存packageとして使いたい場合、stack.yamlに上手い具合に設定して取ってきたpackageにpackage.yamlを追加するようなことはできないでしょうか。<br/><br/>具体的には研究である著者のライブラリを依存パッケージとして利用する際package.yamlはもちろん、packagename.cabalもなかったため、自分で書き加え自分のリポジトリに追加しました。これだと研究成果を公開する際に問題が生じそうなので、gitで管理するのは依存packageのyamlだけにし、利用者がbuildするときpackage本体は自動でとってくるようにしたいと考えております。<br/><br/>よろしくおねがいします</div></div><div class="message" id="message-1546991622.048100"><div class="message__timestamp">2019-01-09<br/>08:53:42 +0900</div><div class="message__header">igrep</div><div class="message__body">そのライブラリーがgitリポジトリーとして公開されているなら、git submoduleで自分のリポジトリーに追加して、<br/>自分のリポジトリーでは<br/><br/><pre>
... 省略 ...
library
  hs-source-dirs: path/to/submodule
... 省略 ...
</pre><br/><br/>と書いたcabalファイルで対象のライブラリーが入ったパスを参照するようにすれば、対象のライブラリーをcabalパッケージとして扱えるようになるはずなので、あとはstack.yamlで <code>extra-deps</code> にそのcabalファイルが入ったパスを書けば良いのではないかと。</div></div><div class="message" id="message-1546992643.048700"><div class="message__timestamp">2019-01-09<br/>09:10:43 +0900</div><div class="message__header">koyama</div><div class="message__body">@koyama has joined the channel</div></div><div class="message" id="message-1546997471.048900"><div class="message__timestamp">2019-01-09<br/>10:31:11 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">(僕はやったことないけど)<br/>stack なら stack.yaml の <code>packages:</code> に追加すればいいんじゃないかな<br/><a href='https://docs.haskellstack.org/en/stable/yaml_configuration/#packages-and-extra-deps'>https://docs.haskellstack.org/en/stable/yaml_configuration/#packages-and-extra-deps</a><br/><pre>
packages:
- .
- path/to/package
</pre></div></div><div class="message" id="message-1546997617.049100"><div class="message__timestamp">2019-01-09<br/>10:33:37 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">こんな感じ<br/><a href='https://github.com/commercialhaskell/stack/blob/9900d99114967698223f43c84e4cedecc24cea97/stack.yaml#L3-L6'>https://github.com/commercialhaskell/stack/blob/9900d99114967698223f43c84e4cedecc24cea97/stack.yaml#L3-L6</a></div></div><div class="message" id="message-1546997661.049400"><div class="message__timestamp">2019-01-09<br/>10:34:21 +0900</div><div class="message__header">matsubara0507</div><div class="message__body"><blockquote>package本体は自動でとってくるようにしたい</blockquote><br/>というかその package 本体はどこかに公開されてる？GitHubとか？</div></div><div class="message" id="message-1547003810.049600"><div class="message__timestamp">2019-01-09<br/>12:16:50 +0900</div><div class="message__header">igrep</div><div class="message__body">最初 <code>packages:</code> に追加する方法を考えたんですが、その方法だと指定したディレクトリーの中にcabalファイルがないので結局ダメなんじゃないかと思いまして…:thinking_face:</div></div><div class="message" id="message-1547003843.049900"><div class="message__timestamp">2019-01-09<br/>12:17:23 +0900</div><div class="message__header">fumieval</div><div class="message__body"><code>traverse f [1,2,3] &lt;$&gt; [False, True]</code>はどうですか？</div></div><div class="message" id="message-1547004229.050100"><div class="message__timestamp">2019-01-09<br/>12:23:49 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">自分で足せばいいかなと思ってた <blockquote>cabal ファイルか package.yaml</blockquote></div></div><div class="message" id="message-1547006071.055100"><div class="message__timestamp">2019-01-09<br/>12:54:31 +0900</div><div class="message__header">sugano</div><div class="message__body">利用したいpackageは <a href='https://www.mathstat.dal.ca/~selinger/quipper/oldreleases.html'>https://www.mathstat.dal.ca/~selinger/quipper/oldreleases.html</a> にあります．一応今はこれに.cabalを追加してmypackageに含めてstack.yamlのpackage:に追加しています．extra-deps: <a href='https://www.mathstat.dal.ca/~selinger/quipper/downloads/quipper-0.8.tgz'>https://www.mathstat.dal.ca/~selinger/quipper/downloads/quipper-0.8.tgz</a> のように追加したらquipperにcabalがないと言われたので．</div></div><div class="message" id="message-1547006184.056400"><div class="message__timestamp">2019-01-09<br/>12:56:24 +0900</div><div class="message__header">sugano</div><div class="message__body">（extra-depsにこのように書けばstack build時に自動でとってきてくれるという認識です）</div></div><div class="message" id="message-1547006299.056900"><div class="message__timestamp">2019-01-09<br/>12:58:19 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">Hackage にあるけど。。。？<br/><a href='http://hackage.haskell.org/package/quipper'>http://hackage.haskell.org/package/quipper</a></div></div><div class="message" id="message-1547006317.057200"><div class="message__timestamp">2019-01-09<br/>12:58:37 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">これでいいなら<br/><pre>
extra-deps:
- quipper-0.8.2
</pre><br/>を stack.yaml に足せば動作するはず</div></div><div class="message" id="message-1547006527.059700"><div class="message__timestamp">2019-01-09<br/>13:02:07 +0900</div><div class="message__header">sugano</div><div class="message__body">hackageの方は関数が足りず、著者のページから持ってくる必要があります...むしろ足りない関数を足したものを自分でhackageに登録すればよかったり...</div></div><div class="message" id="message-1547006912.060000"><div class="message__timestamp">2019-01-09<br/>13:08:32 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">quipper に独自拡張を入れたい的な？</div></div><div class="message" id="message-1547007245.060200"><div class="message__timestamp">2019-01-09<br/>13:14:05 +0900</div><div class="message__header">igrep</div><div class="message__body">ライセンス上問題がなければ追加したものを自分でhackageにアップロードしちゃってもいいんじゃないっすかね。<br/>COPYRIGHTファイルを見た限り3条項BSDかな？<br/>もちろんより丁寧にやるなら作者に聞いた方がいいでしょうけども。</div></div><div class="message" id="message-1547007339.060600"><div class="message__timestamp">2019-01-09<br/>13:15:39 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">更新履歴をみる限り、hackage も著者のサイトのも差はないきがするけど</div></div><div class="message" id="message-1547007476.062500"><div class="message__timestamp">2019-01-09<br/>13:17:56 +0900</div><div class="message__header">sugano</div><div class="message__body">著者の方にはQuipperLibの中にSimulationというモジュールがあると思います</div></div><div class="message" id="message-1547007524.063600"><div class="message__timestamp">2019-01-09<br/>13:18:44 +0900</div><div class="message__header">sugano</div><div class="message__body">ありがとうございます、ライセンスについてよく調べてみます</div></div><div class="message" id="message-1547008007.066400"><div class="message__timestamp">2019-01-09<br/>13:26:47 +0900</div><div class="message__header">sugano</div><div class="message__body">ちなみに、やりたいことはquipperの関数をある型レベル計算を行うモジュールで包む、という感じです</div></div><div class="message" id="message-1547008601.066800"><div class="message__timestamp">2019-01-09<br/>13:36:41 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">igrep さんのいう通り bsd3ライセンスだし、ライセンスのファイルと、unofficial fork であることを足して GitHub にあげちゃってもいい気がする</div></div><div class="message" id="message-1547008707.067000"><div class="message__timestamp">2019-01-09<br/>13:38:27 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">あとは適当に cabal ファイルか stack の設定を足して</div></div><div class="message" id="message-1547011673.068500"><div class="message__timestamp">2019-01-09<br/>14:27:53 +0900</div><div class="message__header">sugano</div><div class="message__body">igrepさん，matsubara0507さんありがとうございます．その方針で進めてみようと思います．</div></div><div class="message" id="message-1547013174.068900"><div class="message__timestamp">2019-01-09<br/>14:52:54 +0900</div><div class="message__header">zokutyou2</div><div class="message__body">@zokutyou2 has joined the channel</div></div><div class="message" id="message-1547018420.073400"><div class="message__timestamp">2019-01-09<br/>16:20:20 +0900</div><div class="message__header">a_kirisaki</div><div class="message__body">[extensible攻略WikiのDotenvレシピ](<https://wiki.hask.moe/Dotenv>)を見ていて疑問点が3つあります<br/>• <code>Data.Extensible.Util</code> の存在<br/>• <code>fromHashMapOf</code> と <code>strings</code> はどのライブラリから？<br/>• 大文字のフィールドに（`itemAssoc`を使わず）ラベルでアクセスする方法<br/>よろしくお願いします</div></div><div class="message" id="message-1547019783.073600"><div class="message__timestamp">2019-01-09<br/>16:43:03 +0900</div><div class="message__header">wado</div><div class="message__body"><code>Data.Extensible.Util</code> は <code>master</code> にマージされていないモジュールなので <code>fromHashMapOf</code> ブランチを参照すると定義されています。(たぶん、そのうちマージされると思います)<br/><a href='https://github.com/fumieval/extensible/tree/fromHashMapOf'>https://github.com/fumieval/extensible/tree/fromHashMapOf</a></div></div><div class="message" id="message-1547020054.073900"><div class="message__timestamp">2019-01-09<br/>16:47:34 +0900</div><div class="message__header">wado</div><div class="message__body"><blockquote>大文字のフィールドに（`itemAssoc`を使わず）ラベルでアクセスする方法</blockquote><br/>OverloadedLabels のページにも少し書いてある通りです。現状はアクセスする方法は無いと思います。<br/><a href='https://wiki.hask.moe/OverloadedLabels'>https://wiki.hask.moe/OverloadedLabels</a><br/><br/>ただ、以下の proposal が受理されたので、近いうち解決しそうな気がします。<br/>Unrestricted OverloadedLabels #170<br/><a href='https://github.com/ghc-proposals/ghc-proposals/pull/170'>https://github.com/ghc-proposals/ghc-proposals/pull/170</a></div></div><div class="message" id="message-1547020153.074300"><div class="message__timestamp">2019-01-09<br/>16:49:13 +0900</div><div class="message__header">a_kirisaki</div><div class="message__body">ありがとうございます！</div></div><div class="message" id="message-1547036246.075200"><div class="message__timestamp">2019-01-09<br/>21:17:26 +0900</div><div class="message__header">hexirp</div><div class="message__body">[] が Traversable で (-&gt;) が Applicative であることを利用するんですね。すごい……。初めに考えたのは <code>func f as bs = fmap (flip (\b -&gt; fmap (\f -&gt; f b)) (fmap f as)) bs</code> です</div></div><div class="message" id="message-1547036490.075400"><div class="message__timestamp">2019-01-09<br/>21:21:30 +0900</div><div class="message__header">hexirp</div><div class="message__body">より一般的な型である <code>(Functor f, Functor g) =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; g b -&gt; g (f c)</code> はこう書くしかないっぽい？</div></div><div class="message" id="message-1547036967.075800"><div class="message__timestamp">2019-01-09<br/>21:29:27 +0900</div><div class="message__header">hexirp</div><div class="message__body">無駄なところを削った <code>func f as bs = fmap (\b -&gt; fmap ($ b) (fmap f as)) bs</code> の方がいいですね</div></div><div class="message" id="message-1547087383.076100"><div class="message__timestamp">2019-01-10<br/>11:29:43 +0900</div><div class="message__header">tatsuhiro.9699</div><div class="message__body">@tatsuhiro.9699 has joined the channel</div></div><div class="message" id="message-1547119093.076500"><div class="message__timestamp">2019-01-10<br/>20:18:13 +0900</div><div class="message__header">kazy.crazycloud</div><div class="message__body">@kazy.crazycloud has joined the channel</div></div><div class="message" id="message-1547212274.076700"><div class="message__timestamp">2019-01-11<br/>22:11:14 +0900</div><div class="message__header">ncaq</div><div class="message__body">自分は改造したやつを使う時は<br/><br/><pre>
extra-deps:
  - ../hakyll
</pre><br/><br/>のように別ディレクトリを参照するようにstack.yamlに書いてますね</div></div><div class="message" id="message-1547387726.078400"><div class="message__timestamp">2019-01-13<br/>22:55:26 +0900</div><div class="message__header">igrep</div><div class="message__body">私が知る限りできないと思っているんですが、Haskellで、moduleをimportしただけで、そのmoduleに含まれている識別子を参照することなく、副作用を起こす（つまり何らかの形でunsafePerformIOを実行する）ことってできるんでしょうか？</div></div><div class="message" id="message-1547387793.078500"><div class="message__timestamp">2019-01-13<br/>22:56:33 +0900</div><div class="message__header">igrep</div><div class="message__body">試しに :point_down: みたいなコードを書いてみたんですが、やっぱりトップレベルでBang patternは使えないと怒られました。<br/><br/><pre>
{-# LANGUAGE BangPatterns #-}

module Mod where

import Debug.Trace

hoge :: ()
!hoge = trace "hoge" ()
</pre></div></div><div class="message" id="message-1547388423.078700"><div class="message__timestamp">2019-01-13<br/>23:07:03 +0900</div><div class="message__header">igrep</div><div class="message__body">... あっ、Template Haskellがあるじゃないか... :cold_sweat:<br/>すみません、Template Haskellを使えば普通にできましたね... :sweat_drops:</div></div></div><div class="pager"><a href="/html/C5666B6BB/33.html" class="pager__previous">Previous</a><a href="/" class="pager__top">Top</a><a href="/html/C5666B6BB/35.html" class="pager__next">Next</a></div></body></html>