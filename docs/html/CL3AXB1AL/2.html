<!DOCTYPE html><html><head><meta charset="utf-8"><title>haskell-jp / atcoder-lang-update #2</title><link rel="stylesheet" href="/slack-log/messages.css" type="text/css" media="screen"></head><body><h1>haskell-jp / atcoder-lang-update #2</h1><div class="pager"><a href="/slack-log/html/CL3AXB1AL/1.html" class="pager__previous">Previous</a><a href="/slack-log/" class="pager__top">Top</a></div><div class="message_list"><div class="message" id="message-1562582116.067100"><div class="message__timestamp">2019-07-08<br/>19:35:16 +0900</div><div class="message__header">wado</div><div class="message__body">AtCoder の提出内容 (ソースコード) を API で取得できればなぁ。</div></div><div class="message" id="message-1562641817.069200"><div class="message__timestamp">2019-07-09<br/>12:10:17 +0900</div><div class="message__header">as_capabl</div><div class="message__body">repaについて、行列積とかはrepa-algorithmの方に入ってるんですね。repa-algorithmを入れるとFFTとかも入ってしまって、上のtweetに引っかかる感じがありますが、どうなんだろう</div></div><div class="message" id="message-1562641982.070300"><div class="message__timestamp">2019-07-09<br/>12:13:02 +0900</div><div class="message__header">as_capabl</div><div class="message__body">AtCoderでFFTを使う問題はそれなりにある<br/>numpyやD言語標準ライブラリにはFFTが入っていて、これらを使った解答もある模様</div></div><div class="message" id="message-1562651863.070800"><div class="message__timestamp">2019-07-09<br/>14:57:43 +0900</div><div class="message__header">qryxip</div><div class="message__body">@qryxip has joined the channel</div></div><div class="message" id="message-1562690725.072400"><div class="message__timestamp">2019-07-10<br/>01:45:25 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">Ubuntu 18.04.2のLive DVDで環境構築を試してますが、 libtinfo.so.6 が見つからないというエラーが出ます。システムに存在するのは libtinfo.so.5 のようです。</div></div><div class="message" id="message-1562690809.072900"><div class="message__timestamp">2019-07-10<br/>01:46:49 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">Live環境じゃなくてちゃんとインストールすれば解消するんですかね？</div></div><div class="message" id="message-1562691222.073700"><div class="message__timestamp">2019-07-10<br/>01:53:42 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body"><a href='https://packages.ubuntu.com/ja/cosmic/libs/libtinfo6'>https://packages.ubuntu.com/ja/cosmic/libs/libtinfo6</a> libtinfo6 は cosmic (18.10) 以降っぽい？</div></div><div class="message" id="message-1562691854.074600"><div class="message__timestamp">2019-07-10<br/>02:04:14 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">GHC 8.2.2はインストール可能、GHC 8.4以降はインストール不可っぽいです。</div></div><div class="message" id="message-1562692858.076500"><div class="message__timestamp">2019-07-10<br/>02:20:58 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">Ubuntu 18.04.2にghcupでGHC 8.6.5の導入に成功したので、スレッド形式でメモしておきます。</div></div><div class="message" id="message-1562692900.076600"><div class="message__timestamp">2019-07-10<br/>02:21:40 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">ghcupは公式で配布されているバイナリを取ってくるわけですが、公式で配布されているLinux向けのバイナリにはディストリごとにいくつか種類があります。 <a href='https://www.haskell.org/ghc/download_ghc_8_6_5.html'>https://www.haskell.org/ghc/download_ghc_8_6_5.html</a></div></div><div class="message" id="message-1562693034.076800"><div class="message__timestamp">2019-07-10<br/>02:23:54 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">GHC 8.6.5の場合は、Linux (x86_64)に対して Debian 9 / Debian 9 (with DWARF support) / Debian 8 / Fedora 27 が用意されています。Ubuntu向けのはありません。</div></div><div class="message" id="message-1562693158.077000"><div class="message__timestamp">2019-07-10<br/>02:25:58 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">じゃあUbuntuでghcupを実行したらどれがインストールされるのかというと、 .download-urls というファイルの指定によって決まります。今のところ、Ubuntu向けにはFedora用バイナリが使われるようです。 <a href='https://gitlab.haskell.org/haskell/ghcup/blob/master/.download-urls'>https://gitlab.haskell.org/haskell/ghcup/blob/master/.download-urls</a></div></div><div class="message" id="message-1562693288.077300"><div class="message__timestamp">2019-07-10<br/>02:28:08 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">.download-urls のURLをカスタマイズしたい場合は、環境変数 <code>GHCUP_META_DOWNLOAD_URL</code> を設定します。実際に使われるURLは <code>ghcup debug-info</code> で確認できます。</div></div><div class="message" id="message-1562693455.077500"><div class="message__timestamp">2019-07-10<br/>02:30:55 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">最新のUbuntuは知りませんが、Ubuntu 18.04に関してはDebian 8かDebian 9向けのバイナリを使うようにしたいところです。そのために .download-urls の内容をカスタマイズします（公式の .download-urls をダウンロードして手元でいじり、先述の環境変数に <code>file://$HOME/.download-urls</code> みたいな感じで設定します）。</div></div><div class="message" id="message-1562693556.077700"><div class="message__timestamp">2019-07-10<br/>02:32:36 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">Debian 9向けのバイナリを使いたい場合は、 .download-urls の <code>debian=9,debian,mint</code> となっている部分を <code>...,mint,ubuntu=18.04</code> に書き換えます。</div></div><div class="message" id="message-1562693729.077900"><div class="message__timestamp">2019-07-10<br/>02:35:29 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">Debian 9向けのバイナリに関してはまだ <code>ghc-8.6.5 --version</code> くらいしか動作確認できていませんが、ちゃんと動作することが確認出来たらghcupの方へMerge Requestを投げるとよさそうです。</div></div><div class="message" id="message-1562694220.078100"><div class="message__timestamp">2019-07-10<br/>02:43:40 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">stack setupはどうしているのかと思ったら、実際にシステムに存在する共有ライブラリを調べてダウンロードするバイナリを決めているみたいですね。えらい <a href='https://github.com/commercialhaskell/stack/blob/master/src/Stack/Setup.hs#L907'>https://github.com/commercialhaskell/stack/blob/master/src/Stack/Setup.hs#L907</a> <a href='https://raw.githubusercontent.com/fpco/stackage-content/master/stack/stack-setup-2.yaml'>https://raw.githubusercontent.com/fpco/stackage-content/master/stack/stack-setup-2.yaml</a></div></div><div class="message" id="message-1562716351.079300"><div class="message__timestamp">2019-07-10<br/>08:52:31 +0900</div><div class="message__header">igrep</div><div class="message__body">Oh... <a href='https://github.com/haskell-jp/atcoder-haskell-resources/blob/master/spec.md'>https://github.com/haskell-jp/atcoder-haskell-resources/blob/master/spec.md</a> の手順ではうまくいっているように書いてありましたが... なぜ食い違ってしまったんだろう... :confused:</div></div><div class="message" id="message-1562717142.081500"><div class="message__timestamp">2019-07-10<br/>09:05:42 +0900</div><div class="message__header">wado</div><div class="message__body">たしかに不思議ですね。Docker でしか確認してなかったので、追試助かります！<br/><br/>Ubuntu 18.04 のインスタンスを実際に作って、もう一度確認してみますね。</div></div><div class="message" id="message-1562722002.083700"><div class="message__timestamp">2019-07-10<br/>10:26:42 +0900</div><div class="message__header">wado</div><div class="message__body"><blockquote>Ubuntu 18.04.2のLive DVDで環境構築を試してますが、 libtinfo.so.6 が見つからないというエラーが出ます。システムに存在するのは libtinfo.so.5 のようです。</blockquote><br/>AtCoder と同じような環境で確かめたところ、たしかにエラーが再現しました。(Docker は何で大丈夫だったんだろう・・・)<br/><br/><pre>
$ uname -a
Linux ip-***_***_***_*** 4.15.0-1043-aws #45-Ubuntu SMP Mon Jun 24 14:07:03 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
$ cat /etc/lsb-release
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=18.04
DISTRIB_CODENAME=bionic
DISTRIB_DESCRIPTION="Ubuntu 18.04.2 LTS"

$ curl <https://get-ghcup.haskell.org> -sSf | sh
"/home/ubuntu/.ghcup/ghc/8.6.5/lib/ghc-8.6.5/bin/ghc-pkg" --force --global-package-db "/home/ubuntu/.ghcup/ghc/8.6.5/lib/ghc-8.6.5/package.conf.d" update rts/dist/package.conf.install
/home/ubuntu/.ghcup/ghc/8.6.5/lib/ghc-8.6.5/bin/ghc-pkg: error while loading shared libraries: libtinfo.so.6: cannot open shared object file: No such file or directory
<http://ghc.mk:985|ghc.mk:985>: recipe for target 'install_packages' failed
make[1]: *** [install_packages] Error 127
Makefile:51: recipe for target 'install' failed
make: *** [install] Error 2
Failed to install, consider updating this script via: ghcup upgrade
"ghcup --cache install" failed!
</pre></div></div><div class="message" id="message-1562722934.085700"><div class="message__timestamp">2019-07-10<br/>10:42:14 +0900</div><div class="message__header">wado</div><div class="message__body">@minorinoki_haskjp<br/>だめぽさんのメモ通りに <code>download-urls</code> を修正したファイルをリポジトリにあげました。詳細なメモで助かりました！ありがとうございます。<br/><a href='https://github.com/haskell-jp/atcoder-haskell-resources/blob/master/download-urls'>https://github.com/haskell-jp/atcoder-haskell-resources/blob/master/download-urls</a><br/><br/>手元の環境では、以下の手順でインストールに成功したので、ドキュメントを更新しておきます。<br/><br/><pre>
$ sudo apt-get update
$ sudo apt-get install -y curl g++ gcc libgmp-dev libtinfo-dev make ncurses-dev python3 libnuma-dev coreutils

$ export GHCUP_META_DOWNLOAD_URL=<https://raw.githubusercontent.com/haskell-jp/atcoder-haskell-resources/master/download-urls>

$ curl <https://get-ghcup.haskell.org> -sSf | sh
</pre></div></div><div class="message" id="message-1562725052.087300"><div class="message__timestamp">2019-07-10<br/>11:17:32 +0900</div><div class="message__header">wado</div><div class="message__body">修正版です:grinning:<br/><a href='https://github.com/haskell-jp/atcoder-haskell-resources/blob/master/spec.md'>https://github.com/haskell-jp/atcoder-haskell-resources/blob/master/spec.md</a></div></div><div class="message" id="message-1562730005.088000"><div class="message__timestamp">2019-07-10<br/>12:40:05 +0900</div><div class="message__header">igrep</div><div class="message__body">確かに <a href='https://packages.ubuntu.com/search?keywords=libtinfo'>https://packages.ubuntu.com/search?keywords=libtinfo</a> で調べた限り、libtinfo6が使えるのは18.10からみたいですね。</div></div><div class="message" id="message-1562736719.088400"><div class="message__timestamp">2019-07-10<br/>14:31:59 +0900</div><div class="message__header">wado</div><div class="message__body"><code>ghcup print-system-reqs</code> の結果が間違っていたので修正しました。<br/><code>Docker</code> で実行した時は <code>default</code> の方が表示されてたみたいです。<br/><a href='https://gitlab.haskell.org/haskell/ghcup/blob/master/.requirements/ghc/default'>https://gitlab.haskell.org/haskell/ghcup/blob/master/.requirements/ghc/default</a><br/><br/>正しくはこっち<br/><a href='https://gitlab.haskell.org/haskell/ghcup/blob/master/.requirements/ghc/ubuntu'>https://gitlab.haskell.org/haskell/ghcup/blob/master/.requirements/ghc/ubuntu</a></div></div><div class="message" id="message-1562738879.089500"><div class="message__timestamp">2019-07-10<br/>15:07:59 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body"><a href='https://gitlab.haskell.org/haskell/ghcup/issues/108'>https://gitlab.haskell.org/haskell/ghcup/issues/108</a> ghcupがUbuntuでFedora向けバイナリを使うようになったのはつい数日前っぽいですね</div></div><div class="message" id="message-1562738961.090100"><div class="message__timestamp">2019-07-10<br/>15:09:21 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body"><blockquote>The current bindist for ubuntu (<https://downloads.haskell.org/~ghc/8.6.5/ghc-8.6.5-x86_64-deb9-linux.tar.xz>) tries to use libtinfo.so.5, but since at least 16.04, Ubuntu provides libtinfo.so.6 but not libtinfo.so.5.</blockquote>:thinking_face:</div></div><div class="message" id="message-1562740739.090800"><div class="message__timestamp">2019-07-10<br/>15:38:59 +0900</div><div class="message__header">hato2000</div><div class="message__body">@hato2000 has joined the channel</div></div><div class="message" id="message-1562740780.091000"><div class="message__timestamp">2019-07-10<br/>15:39:40 +0900</div><div class="message__header">statiolake</div><div class="message__body">@statiolake has joined the channel</div></div><div class="message" id="message-1562741051.091100"><div class="message__timestamp">2019-07-10<br/>15:44:11 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">ghcupの方にIssue立てました <a href='https://gitlab.haskell.org/haskell/ghcup/issues/111'>https://gitlab.haskell.org/haskell/ghcup/issues/111</a></div></div><div class="message" id="message-1562743055.094700"><div class="message__timestamp">2019-07-10<br/>16:17:35 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">AtCoderでLLVMバックエンドを試せると楽しそうなのでやってみました。<br/><a href='https://gitlab.haskell.org/ghc/ghc/wikis/commentary/compiler/backends/llvm/installing'>https://gitlab.haskell.org/ghc/ghc/wikis/commentary/compiler/backends/llvm/installing</a> によると、GHC 8.6が依存するLLVMのバージョンは6.0なので、aptで <code>llvm-6.0</code> を入れます。<br/>GHCに <code>-fllvm</code> を指定するとLLVMの <code>opt</code> コマンドを呼び出そうとするわけですがこの状態では <code>opt</code> は <code>$PATH</code> に含まれていない（代わりに <code>opt-6.0</code> がある）ので、<br/><pre>
env PATH=/usr/lib/llvm-6.0/bin:$PATH ghc -fllvm -O2 Main.hs
</pre><br/>という風にすると良いようです。</div></div><div class="message" id="message-1562743299.095800"><div class="message__timestamp">2019-07-10<br/>16:21:39 +0900</div><div class="message__header">minorinoki_haskjp</div><div class="message__body">環境変数をいじる代わりに<br/><pre>
ghc -O2 -fllvm -pgmlo opt-6.0 -pgmlc llc-6.0 Main.hs
</pre><br/>でも良いですね。</div></div><div class="message" id="message-1562751484.096400"><div class="message__timestamp">2019-07-10<br/>18:38:04 +0900</div><div class="message__header">igrep</div><div class="message__body">Haskell (GHC (LLVM))って行を例のスプレッドシートに追加してみるのも良さそうですね！ :+1:</div></div><div class="message" id="message-1562816685.096700"><div class="message__timestamp">2019-07-11<br/>12:44:45 +0900</div><div class="message__header">wado</div><div class="message__body">修正されたみたいです！:tada:<br/><a href='https://gitlab.haskell.org/haskell/ghcup/merge_requests/108'>https://gitlab.haskell.org/haskell/ghcup/merge_requests/108</a><br/><br/>環境構築方法も更新しておきます。</div></div><div class="message" id="message-1562849053.097300"><div class="message__timestamp">2019-07-11<br/>21:44:13 +0900</div><div class="message__header">deltalphan</div><div class="message__body">@deltalphan has joined the channel</div></div><div class="message" id="message-1562946592.097500"><div class="message__timestamp">2019-07-13<br/>00:49:52 +0900</div><div class="message__header">tos.lunar</div><div class="message__body">@tos.lunar has joined the channel</div></div><div class="message" id="message-1563010543.097700"><div class="message__timestamp">2019-07-13<br/>18:35:43 +0900</div><div class="message__header">e1q18048</div><div class="message__body">@e1q18048 has joined the channel</div></div><div class="message" id="message-1563782710.000600"><div class="message__timestamp">2019-07-22<br/>17:05:10 +0900</div><div class="message__header">gettaplacetogo</div><div class="message__body">今からpackageを追加希望するのってありですかね？</div></div><div class="message" id="message-1563783347.002100"><div class="message__timestamp">2019-07-22<br/>17:15:47 +0900</div><div class="message__header">igrep</div><div class="message__body">うーん、どこかで締め切りについてちょくだいさんが触れていたような気がするんですが、見当たらないな... :confused:</div></div><div class="message" id="message-1563783427.003500"><div class="message__timestamp">2019-07-22<br/>17:17:07 +0900</div><div class="message__header">igrep</div><div class="message__body">いずれにしても、締め切りは基本今回のLanguage Updateの締め切りに準ずる形でいいと思うのですが...</div></div><div class="message" id="message-1563783505.004700"><div class="message__timestamp">2019-07-22<br/>17:18:25 +0900</div><div class="message__header">gettaplacetogo</div><div class="message__body">Augustに実施するとは聞いてます．chokudaiさんのツイートはone-by-oneで通知が来るように設定してあるので，他の情報は多分無いです．</div></div><div class="message" id="message-1563783655.007400"><div class="message__timestamp">2019-07-22<br/>17:20:55 +0900</div><div class="message__header">gettaplacetogo</div><div class="message__body">massiv. 希望理由: 高次元のaligned vectorを扱うmoduleであって，<br/>- mutable &lt;-&gt; immutable 相互変換可能<br/>- map,fold等がそのまま使える<br/>を満たしているものとして希望した．</div></div><div class="message" id="message-1563784053.010700"><div class="message__timestamp">2019-07-22<br/>17:27:33 +0900</div><div class="message__header">gettaplacetogo</div><div class="message__body"><pre>
total &lt;- VUM.new (h*w)
let !xys = force $ V.unfoldrN h (\ !x -&gt; Just $! VUM.splitAt w x) total
</pre><br/>とかやるのもうめんどくさくて…．</div></div><div class="message" id="message-1563801459.011000"><div class="message__timestamp">2019-07-22<br/>22:17:39 +0900</div><div class="message__header">ryo.furutani</div><div class="message__body">@ryo.furutani has joined the channel</div></div><div class="message" id="message-1563944548.011200"><div class="message__timestamp">2019-07-24<br/>14:02:28 +0900</div><div class="message__header">tikuwakunn</div><div class="message__body">@tikuwakunn has joined the channel</div></div><div class="message" id="message-1563975294.011400"><div class="message__timestamp">2019-07-24<br/>22:34:54 +0900</div><div class="message__header">irxnjhtchlnrw</div><div class="message__body">@irxnjhtchlnrw has joined the channel</div></div><div class="message" id="message-1564220309.011600"><div class="message__timestamp">2019-07-27<br/>18:38:29 +0900</div><div class="message__header">kafu.h1998</div><div class="message__body">@kafu.h1998 has joined the channel</div></div><div class="message" id="message-1564275017.011800"><div class="message__timestamp">2019-07-28<br/>09:50:17 +0900</div><div class="message__header">nnhixi</div><div class="message__body">@nnhixi has joined the channel</div></div></div><div class="pager"><a href="/slack-log/html/CL3AXB1AL/1.html" class="pager__previous">Previous</a><a href="/slack-log/" class="pager__top">Top</a></div></body></html>