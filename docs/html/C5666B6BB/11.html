<!DOCTYPE html><html><head><meta charset="utf-8"><title>haskell-jp / questions #11</title><link rel="stylesheet" href="/slack-log/messages.css" type="text/css" media="screen"></head><body><h1>haskell-jp / questions #11</h1><div class="pager"><a href="/slack-log/html/C5666B6BB/10.html" class="pager__previous">Previous</a><a href="/slack-log/" class="pager__top">Top</a><a href="/slack-log/html/C5666B6BB/12.html" class="pager__next">Next</a></div><div class="message_list"><div class="message" id="message-1516338818.000123"><div class="message__timestamp">2018-01-19<br/>14:13:38 +0900</div><div class="message__header">kazu</div><div class="message__body">わーん。</div></div><div class="message" id="message-1516338971.000115"><div class="message__timestamp">2018-01-19<br/>14:16:11 +0900</div><div class="message__header">kazu</div><div class="message__body"><pre>
accept :: Socket -&gt; IO (Socket, SockAddr)
</pre><br/>の <code>SockAddr</code> をユーザが拡張できるように<br/><pre>
accept :: SocketAddress sa =&gt; Socket -&gt; IO (Socket, sa)
</pre><br/>としたかったんですが、型が決まらないので、<br/><pre>
accept :: Socket -&gt; IO (Socket, SockAddr)
accept' :: SocketAddress sa =&gt; Socket -&gt; IO (Socket, sa)
</pre><br/>としてるんですが、かっこ悪いですねぇ。</div></div><div class="message" id="message-1516373715.000645"><div class="message__timestamp">2018-01-19<br/>23:55:15 +0900</div><div class="message__header">myuon_myon</div><div class="message__body">使ったことないのでわからないんですがExtendedDefaultRulesでこういうことが出来たりしないですかね？<br/><a href='https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html?highlight=extendeddefaultrules#ghc-flag--XExtendedDefaultRules'>https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html?highlight=extendeddefaultrules#ghc-flag--XExtendedDefaultRules</a></div></div><div class="message" id="message-1516375614.000802"><div class="message__timestamp">2018-01-20<br/>00:26:54 +0900</div><div class="message__header">mizunashi-mana</div><div class="message__body"><code>ExtendedDefaultRules</code> は，ここにあるクラスしか，適用できない感がありますね<br/><a href='https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#interactive-classes'>https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#interactive-classes</a><br/><br/><code>TypeApplication</code> を使って， <code>accept @SockAddr</code> とする前提でAPIを設計する(いちよシグネチャを明示的に書けば， <code>TypeApplication</code> を使わなくても良い)感じはダメなんですかね？</div></div><div class="message" id="message-1516417192.000137"><div class="message__timestamp">2018-01-20<br/>11:59:52 +0900</div><div class="message__header">as_capabl</div><div class="message__body">あと <code>OverloadedString</code> 拡張を有効にした時は <code>IsString</code> にも指定できるんだそうです。 <a href='https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#overloaded-string-literals'>https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#overloaded-string-literals</a></div></div><div class="message" id="message-1516451823.000112"><div class="message__timestamp">2018-01-20<br/>21:37:03 +0900</div><div class="message__header">rystylee8</div><div class="message__body">@rystylee8 has joined the channel</div></div><div class="message" id="message-1516532864.000032"><div class="message__timestamp">2018-01-21<br/>20:07:44 +0900</div><div class="message__header">masakolee</div><div class="message__body">@masakolee has joined the channel</div></div><div class="message" id="message-1516556572.000116"><div class="message__timestamp">2018-01-22<br/>02:42:52 +0900</div><div class="message__header">being.paperlefthand</div><div class="message__body">@being.paperlefthand has joined the channel</div></div><div class="message" id="message-1516590817.000228"><div class="message__timestamp">2018-01-22<br/>12:13:37 +0900</div><div class="message__header">kazu</div><div class="message__body">どうもうまい方法はなさそうなので、Network.Socket は SockAddr 固定とし、generic な API は別モジュールで提供することにします。</div></div><div class="message" id="message-1516590833.000221"><div class="message__timestamp">2018-01-22<br/>12:13:53 +0900</div><div class="message__header">kazu</div><div class="message__body">みなさん、いろいろありがとうございました。勉強になりました。</div></div><div class="message" id="message-1516762993.000127"><div class="message__timestamp">2018-01-24<br/>12:03:13 +0900</div><div class="message__header">h_hosokawa</div><div class="message__body">@h_hosokawa has joined the channel</div></div><div class="message" id="message-1516784893.000214"><div class="message__timestamp">2018-01-24<br/>18:08:13 +0900</div><div class="message__header">ice08235523</div><div class="message__body">@ice08235523 has joined the channel</div></div><div class="message" id="message-1516877283.000417"><div class="message__timestamp">2018-01-25<br/>19:48:03 +0900</div><div class="message__header">yokomotod</div><div class="message__body">@yokomotod has joined the channel</div></div><div class="message" id="message-1517071460.000046"><div class="message__timestamp">2018-01-28<br/>01:44:20 +0900</div><div class="message__header">mizunashi-mana</div><div class="message__body"><code>Generic2</code> クラスがない理由ってなんか技術的な理由だったりするんでしょうか？</div></div><div class="message" id="message-1517175539.000040"><div class="message__timestamp">2018-01-29<br/>06:38:59 +0900</div><div class="message__header">tukejonny</div><div class="message__body">@tukejonny has joined the channel</div></div><div class="message" id="message-1517195904.000180"><div class="message__timestamp">2018-01-29<br/>12:18:24 +0900</div><div class="message__header">shnarazk</div><div class="message__body">@shnarazk has joined the channel</div></div><div class="message" id="message-1517213080.000038"><div class="message__timestamp">2018-01-29<br/>17:04:40 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">Queue のライブラリってありますか？<br/>「Haskell queue」でググると出てくる↓は Stackage には無いから枯れちゃってるのかなぁと思いますし、何がデファクトなんでしょうか？<br/><a href='https://hackage.haskell.org/package/queue'>https://hackage.haskell.org/package/queue</a></div></div><div class="message" id="message-1517214067.000209"><div class="message__timestamp">2018-01-29<br/>17:21:07 +0900</div><div class="message__header">igrep</div><div class="message__body">「Deprecated」って書いてありますもんね。 :disappointed: <br/>ほしいのは並行計算で使う方じゃないキューですよね？<br/>であれば、<br/><a href='https://wiki.haskell.jp/データ構造列伝'>https://wiki.haskell.jp/データ構造列伝</a> でも触れているSeqか、確か銀行家キューを実装したパッケージもあったよな。。。 :thinking_face:</div></div><div class="message" id="message-1517214280.000316"><div class="message__timestamp">2018-01-29<br/>17:24:40 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">ふつーの FIFO なデータ構造ですね<br/>deque とか優先度つきのキューなら何種類かあるんですけど、それはそれでどれを使えばいいのやら。<br/>こんぐらいは自前で実装するのが当たり前なんですかね :thinking_face: </div></div><div class="message" id="message-1517215021.000092"><div class="message__timestamp">2018-01-29<br/>17:37:01 +0900</div><div class="message__header">igrep</div><div class="message__body"><a href='https://hackage.haskell.org/package/dequeue-0.1.12/docs/Data-Dequeue.html'>https://hackage.haskell.org/package/dequeue-0.1.12/docs/Data-Dequeue.html</a><br/>これか。<br/><a href='http://www.kmonos.net/pub/Presen/PFDS.pdf'>http://www.kmonos.net/pub/Presen/PFDS.pdf</a> とか  <a href='http://fumieval.hatenablog.com/entry/2015/02/05/174342'>http://fumieval.hatenablog.com/entry/2015/02/05/174342</a> で解説されている。</div></div><div class="message" id="message-1517215104.000104"><div class="message__timestamp">2018-01-29<br/>17:38:24 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">なるほど</div></div><div class="message" id="message-1517215462.000546"><div class="message__timestamp">2018-01-29<br/>17:44:22 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">あでも、これも stackage にはない....</div></div><div class="message" id="message-1517215506.000432"><div class="message__timestamp">2018-01-29<br/>17:45:06 +0900</div><div class="message__header">igrep</div><div class="message__body">まぁstackageに置いているかどうかは作った人の裁量しだいなんで、的確な基準ではないんじゃないかな、と思います。</div></div><div class="message" id="message-1517215772.000146"><div class="message__timestamp">2018-01-29<br/>17:49:32 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">まぁそうですね</div></div><div class="message" id="message-1517220133.000223"><div class="message__timestamp">2018-01-29<br/>19:02:13 +0900</div><div class="message__header">kakkun61</div><div class="message__body"><pre>
$ stack new blog hakyll-template
$ cd blog
# stack.yaml の resolver を nightly-2018-01-29 に
$ stack build
</pre><br/>すると ↓ のようなエラーが出るのですが解決方法が分かりません。<br/>Objective-C のコードを gcc が理解できてないんだろうなぐらいは分かるのですが。<br/>• OS X El Capitan 10.11.6<br/>• stack 1.6.3</div></div><div class="message" id="message-1517220193.000245"><div class="message__timestamp">2018-01-29<br/>19:03:13 +0900</div><div class="message__header">kakkun61</div><div class="message__body">@kakkun61 uploaded a file: <a href='https://haskell-jp.slack.com/files/U4L0B71L1/F9031NU0L/building_hakyll_on_os_x.txt'>building hakyll on OS X</a></div></div><div class="message" id="message-1517220603.000159"><div class="message__timestamp">2018-01-29<br/>19:10:03 +0900</div><div class="message__header">igrep</div><div class="message__body">恐らく別件ですが類似の問題:<br/><a href='https://github.com/luite/hfsevents/issues/9'>https://github.com/luite/hfsevents/issues/9</a><br/>報告した方がいいかもですね。。。<br/><br/>ちなみに、念のため言うと、GCCはObjective-Cもちゃんとサポートしています。</div></div><div class="message" id="message-1517223395.000242"><div class="message__timestamp">2018-01-29<br/>19:56:35 +0900</div><div class="message__header">kakkun61</div><div class="message__body">あ、まさに hfsevents のビルドでこけてるのでこれっぽい</div></div><div class="message" id="message-1517225648.000137"><div class="message__timestamp">2018-01-29<br/>20:34:08 +0900</div><div class="message__header">fumieval</div><div class="message__body">コミュニティに与えた損害の埋め合わせのために、明日は仕事を休み、Haskell-jpに貢献できるようなことに費やします。Trelloにあったコーディング規約について、Wikiに投稿しようと考えています。他にも、何か案があればご教示を願いたいです</div></div><div class="message" id="message-1517225769.000015"><div class="message__timestamp">2018-01-29<br/>20:36:09 +0900</div><div class="message__header">kakkun61</div><div class="message__body">そのイシューに Apple's Clang/LLVM 使えとあって Free Software Foundation GCC へのパスを消したら通りました<br/>stack の --with-gcc をオプションや stack.yaml ファイルに書いたりして GCC/Clang と FSF GCC と試したんだけどなぁ</div></div><div class="message" id="message-1517225824.000368"><div class="message__timestamp">2018-01-29<br/>20:37:04 +0900</div><div class="message__header">kakkun61</div><div class="message__body">GCC/Clang と書いているのはバックエンドが Clang だけど GCC 互換インターフェースをそなえている Apple の GCC です</div></div><div class="message" id="message-1517233777.000416"><div class="message__timestamp">2018-01-29<br/>22:49:37 +0900</div><div class="message__header">mizunashi-mana</div><div class="message__body">これはダメなんでしょうか？使ったことないんですけど<br/><a href='https://hackage.haskell.org/package/heaps-0.3.6'>https://hackage.haskell.org/package/heaps-0.3.6</a></div></div><div class="message" id="message-1517234352.000109"><div class="message__timestamp">2018-01-29<br/>22:59:12 +0900</div><div class="message__header">mizunashi-mana</div><div class="message__body">Oh… FIFOなのが欲しいんですね．</div></div><div class="message" id="message-1517234501.000015"><div class="message__timestamp">2018-01-29<br/>23:01:41 +0900</div><div class="message__header">mizunashi-mana</div><div class="message__body">double-endedなのは， <a href='https://hackage.haskell.org/package/deque-0.2/docs/Deque.html'>https://hackage.haskell.org/package/deque-0.2/docs/Deque.html</a> もあるっぽいですが，どっちもあんまメンテされてなさそうですね… :sweat_smile:</div></div><div class="message" id="message-1517234818.000018"><div class="message__timestamp">2018-01-29<br/>23:06:58 +0900</div><div class="message__header">satopen1729</div><div class="message__body">@satopen1729 has joined the channel</div></div><div class="message" id="message-1517234955.000385"><div class="message__timestamp">2018-01-29<br/>23:09:15 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">kazu さんが昔記事にかいてるみたいに、需要がそもそも無いんですかね :sweat_smile: <br/><a href='http://d.hatena.ne.jp/kazu-yamamoto/touch/20121107/1352259739'>http://d.hatena.ne.jp/kazu-yamamoto/touch/20121107/1352259739</a><br/><br/>効率が要るという訳でもないですし、おとなしく containers の Seq を使っておきます…<br/>ありがとうございました。</div></div><div class="message" id="message-1517274454.000281"><div class="message__timestamp">2018-01-30<br/>10:07:34 +0900</div><div class="message__header">igrep</div><div class="message__body"><a href='#C563RLDA4'>haskell-jp-status</a> に移します。</div></div><div class="message" id="message-1517301958.000283"><div class="message__timestamp">2018-01-30<br/>17:45:58 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">Haskell の歴史 :kininaru: <br/><a href='https://twitter.com/EzoeRyou/status/958258650505625603'>https://twitter.com/EzoeRyou/status/958258650505625603</a></div></div><div class="message" id="message-1517304309.000199"><div class="message__timestamp">2018-01-30<br/>18:25:09 +0900</div><div class="message__header">igrep</div><div class="message__body">今更なんですけど、実はほしかったのはdlistだったりしない？<br/><a href='https://hackage.haskell.org/package/dlist-0.8.0.4/docs/Data-DList.html'>https://hackage.haskell.org/package/dlist-0.8.0.4/docs/Data-DList.html</a><br/>後ろに追加していって最後にまとめて先頭から処理する、みたいな用途だと十分いけるのかな、と思うのですがいかがでしょう？</div></div><div class="message" id="message-1517317165.000053"><div class="message__timestamp">2018-01-30<br/>21:59:25 +0900</div><div class="message__header">takenobu.hs</div><div class="message__body">Applicativeも含めた型の俯瞰図の、歴史のスナップショットの２点はこういうのもありますね。<br/><br/>Typeclasspedia の昔の版（ApplicativeとMonadが切れてるころ）の日本語訳<br/><a href='http://snak.tdiary.net/20091020.html'>http://snak.tdiary.net/20091020.html</a><br/><br/>Typeclasspedia のAMPとFTPの各プロポーザル反映後の最新版<br/><a href='https://byorgey.wordpress.com/2017/06/07/the-typeclassopedia-is-now-up-to-date/'>https://byorgey.wordpress.com/2017/06/07/the-typeclassopedia-is-now-up-to-date/</a><br/><a href='https://wiki.haskell.org/Typeclassopedia'>https://wiki.haskell.org/Typeclassopedia</a></div></div><div class="message" id="message-1517318564.000518"><div class="message__timestamp">2018-01-30<br/>22:22:44 +0900</div><div class="message__header">matsubara0507</div><div class="message__body">DList は良く分からないですけど、ぼくが欲しかったのは、本当に一般的な FIFO キューですので違うかなぁ。</div></div><div class="message" id="message-1517805452.000096"><div class="message__timestamp">2018-02-05<br/>13:37:32 +0900</div><div class="message__header">kazu</div><div class="message__body">教えてください。<br/><br/><pre>
class Foo a where
    toFoo  :: Int -&gt; a
    fromFoo :: a -&gt; Int
</pre><br/><br/>という型クラスがあったとして、<br/><br/><pre>
intToInt :: Int -&gt; Int
intToInt = fromFoo . toFoo
</pre><br/><br/>というコードを書きたいとき、中間の Foo a =&gt; a が一致することを要求するよう要求し、型検査を通す方法ってありますか？</div></div><div class="message" id="message-1517808271.000167"><div class="message__timestamp">2018-02-05<br/>14:24:31 +0900</div><div class="message__header">igrep</div><div class="message__body">ぱっと思いつくのは <code>TypeApplication</code> ですね。<br/><a href='https://kseo.github.io/posts/2017-01-08-visible-type-application-ghc8.html'>https://kseo.github.io/posts/2017-01-08-visible-type-application-ghc8.html</a></div></div><div class="message" id="message-1517809245.000109"><div class="message__timestamp">2018-02-05<br/>14:40:45 +0900</div><div class="message__header">hiratara</div><div class="message__body">どの <code>Foo</code> のインスタンスを使うかで <code>intToInt</code> の実装は変わってしまうので、 <code>a</code> からは逃げられない気がしますよね・・・。<br/><pre>
{-# LANGUAGE TypeApplications #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE AllowAmbiguousTypes #-}

class Foo a where
    toFoo  :: Int -&gt; a
    fromFoo :: a -&gt; Int

intToInt :: forall a. Foo a =&gt; Int -&gt; Int
intToInt = fromFoo . toFoo @a
</pre></div></div><div class="message" id="message-1517810528.000040"><div class="message__timestamp">2018-02-05<br/>15:02:08 +0900</div><div class="message__header">nobsun</div><div class="message__body">具体的な Foo のインスタンスを宣言してそれを使うようにするというのはどうですか？<br/><br/><pre>
{-# LANGUAGE TypeApplications #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE GADTs #-}

class Foo a where
  toFoo :: Int -&gt; a
  fromFoo :: a -&gt; Int

instance Foo Integer where
  toFoo = toInteger
  fromFoo = fromInteger

intToInt :: forall a. (Foo a, a ~ Integer) =&gt; Int -&gt; Int
intToInt = fromFoo . toFoo @a
</pre></div></div><div class="message" id="message-1517810968.000148"><div class="message__timestamp">2018-02-05<br/>15:09:28 +0900</div><div class="message__header">kazu</div><div class="message__body">ありがとうございます。<br/>TypeApplications でできることは確かめました。<br/>しかし、networkライブラリのメインテナとしては、GHC 7も救わないといけません。。。</div></div><div class="message" id="message-1517811045.000054"><div class="message__timestamp">2018-02-05<br/>15:10:45 +0900</div><div class="message__header">fumieval</div><div class="message__body">forall単独で変数を導入できるのは8.2からなので、Proxyを引数に加えてScopedTypeVariableを利用する必要があると思います。</div></div><div class="message" id="message-1517812400.000103"><div class="message__timestamp">2018-02-05<br/>15:33:20 +0900</div><div class="message__header">kazu</div><div class="message__body">ExplicitForAll を書かなくても、GHC <b>8.0</b> では forall が使えちゃうなぁ。</div></div><div class="message" id="message-1517814369.000197"><div class="message__timestamp">2018-02-05<br/>16:06:09 +0900</div><div class="message__header">nobsun</div><div class="message__body">ScopedTypeVariablesを有効にすると ExplicitForAll が有効になります。これはたぶん、7.10 でも同じだった気がします</div></div><div class="message" id="message-1517938152.000785"><div class="message__timestamp">2018-02-07<br/>02:29:12 +0900</div><div class="message__header">hiroto.shioi</div><div class="message__body">明後日Philip Wadler氏の授業を受けるのですが、何か質問とか聞いてみたいことはありますか？（どんどん質問してこいと言われてます）<br/>ちなみに今日の講義内容はProposition as Types, Session type、Process calculusに関するものでした。</div></div></div><div class="pager"><a href="/slack-log/html/C5666B6BB/10.html" class="pager__previous">Previous</a><a href="/slack-log/" class="pager__top">Top</a><a href="/slack-log/html/C5666B6BB/12.html" class="pager__next">Next</a></div></body></html>