<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>haskell-jp / beginners #22</title>
<link rel="stylesheet" href="../../main.css" type="text/css" media="screen">
</head>
<body>
  <div class="ui container">
    <h1>haskell-jp / beginners #22</h1>
    <div class="ui pagination menu">
      <a href="../../html/CR2TETE5R/21.html" class="item">Previous</a>
      <a href="../../" class="item">Top</a>
    </div>
    <div class="ui feed">
      <div class="event" id="message-1665272454.027519">
        <div class="content">
          <div class="summary">
            <div class="user">j.nakajima</div>
            <div class="date"><a class="date" href="#message-1665272454.027519">2022-10-09 08:40:54 +0900</a></div>
          </div>
          <div class="description">@j.nakajima has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1665356484.685789">
        <div class="content">
          <div class="summary">
            <div class="user">Naoya Ito</div>
            <div class="date"><a class="date" href="#message-1665356484.685789">2022-10-10 08:01:24 +0900</a></div>
          </div>
          <div class="description">@Naoya Ito has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1665619227.383829">
        <div class="content">
          <div class="summary">
            <div class="user">Slackbot</div>
            <div class="date"><a class="date" href="#message-1665619227.383829">2022-10-13 09:00:27 +0900</a></div>
          </div>
          <div class="description">Reminder: beginnersチャンネルは、新しい人がスムーズにHaskellに慣れるための質問を歓迎するチャンネルです。 Haskell-Beginners ML や IRCの#haskell-beginners  や RedditのMonthly Hask Anythingのような位置づけを意図しています。  beginnersチャンネルでの回答側は、以下の左側のような応答を厳禁とする運用です。 • それはくだらない質問だ → くだらない質問など無い • その質問は以前にもあった → 質問者はそんなこと知らない • Google検索せよ → 検索できないから質問している  beginnersチャンネルでは、例えば以下のレベルの質問から歓迎します。 • <code>:</code> とは何のことですか。 • タプルとは何ですか。 </div>
        </div>
      </div>
      <div class="event" id="message-1665737308.311929">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1665737308.311929">2022-10-14 17:48:28 +0900</a></div>
          </div>
          <div class="description">Haskellでのデバッグ方法がわからず、質問させていただいてもよろしいでしょうか。<br/>やりたいことは、JavaScriptの`console.log`のように、関数のなかの変数を`GHCi`のコンソールに出力したいです。<br/>具体的には、以下の関数で、`repeatedL1`　の部分がどんな値になっているかを見たいです。<br/><pre>cartCombine :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
cartCombine func l1 l2 = zipWith func newL1 cycledL2
    where
        nToAdd = length l2
        repeatedL1 = map (take nToAdd . repeat) l1
        newL1 = mconcat repeatedL1
        cycledL2 = cycle l2</pre><br/>ここで、<br/><pre>repeatedL1 = map (take nToAdd . repeat) l1
show repeatedL1
newL1 = mconcat repeatedL1
……</pre><br/>などとすると、エラーになってしまいます。<br/><br/>ご教示いただけますと幸いです。<br/>よろしくお願いいたします。</div>
          <a class="link-to-replies" href="22/1665737308.311929.html">... Replies ...</a>
        </div>
      </div>
      <div class="event" id="message-1665918777.693479">
        <div class="content">
          <div class="summary">
            <div class="user">liveinwood</div>
            <div class="date"><a class="date" href="#message-1665918777.693479">2022-10-16 20:12:57 +0900</a></div>
          </div>
          <div class="description">Practical Haskell という本を読んでいます。分からない点があるので質問させてください。<br/><br/><pre>module Main (main) where

import GHC.IO.IOMode (IOMode(ReadMode))
import GHC.IO.Handle (hGetContents, hClose)
import <http://System.IO|System.IO> (openFile)

main :: IO ()
main = do
    h &lt;- openFile "./some.txt" ReadMode
    s &lt;- hGetContents h
    hClose h
    print s</pre><br/>これを実行するとエラーになります。`./some.txt: hGetContents: illegal operation (delayed read on closed handle)`<br/><br/>エラーになる理屈は理解していて、`hClose h`と`print s`を入れ替えれば動作します。<br/>他の解決策として   <code>seq</code> または   <code>deepseq</code>  を使っても解決できると書いてあるのですが、具体的に使い方は書いてありませんでした。<br/><br/><code>hClose h</code> する前に文字列全体を読み込めばいいので、`let !size = length s` を追加して、文字列全体を読み込むように処理を強制しました。これは動作しました。<br/><pre>{-# LANGUAGE BangPatterns #-}
module Main (main) where

import GHC.IO.IOMode (IOMode(ReadMode))
import GHC.IO.Handle (hGetContents, hClose)
import <http://System.IO|System.IO> (openFile)

main :: IO ()
main = do
    h &lt;- openFile "./some.txt" ReadMode
    s &lt;- hGetContents h
    let !size = length s
    hClose h
    print s</pre><br/><code>let !size = length s</code>  を追加したのと同じ理屈で  <code>let ds =  s </code>deepseq` s` を追加したのですが、これだとエラーになります。<br/><br/><pre>{-# LANGUAGE BangPatterns #-}
module Main (main) where

import GHC.IO.IOMode (IOMode(ReadMode))
import GHC.IO.Handle (hGetContents, hClose)
import <http://System.IO|System.IO> (openFile)
import Control.DeepSeq

main :: IO ()
main = do
    h &lt;- openFile "./some.txt" ReadMode
    s &lt;- hGetContents h
    let ds =  s `deepseq` s
    hClose h
    print ds</pre><br/><code>let ds =  s </code>deepseq` s`  ではエラーになる理由をご教示いただけないでしょうか。よろしくお願い致します。</div>
          <a class="link-to-replies" href="22/1665918777.693479.html">... Replies ...</a>
        </div>
      </div>
      <div class="event" id="message-1666062034.575279">
        <div class="content">
          <div class="summary">
            <div class="user">liveinwood</div>
            <div class="date"><a class="date" href="#message-1666062034.575279">2022-10-18 12:00:34 +0900</a></div>
          </div>
          <div class="description">遅延評価についてよく分からなくなってきました。<br/><pre>module Main (main) where

import qualified <http://System.IO|System.IO> as SIO

main :: IO ()
main = do
    h &lt;- SIO.openFile "./input.txt" SIO.ReadMode
    content &lt;- SIO.hGetContents h
    SIO.hClose h
    print content</pre><br/>これは実行するとエラーになる理由はわかります。`content` を評価する時には既にファイルがクローズされているから。<br/><br/><pre>module Main (main) where

main :: IO ()
main = do
    putStrLn "please input1 "
    input &lt;- getLine
    putStrLn "please input2 "
    putStrLn $ "your input is " ++ input</pre><br/>同様に考えて、 <code>input</code>を評価する時に標準入力を受け付けることになり、下のような出力順になるのでは？と考えたのですが、<br/>そうはならず。コードに書いてある順序通りの出力になりました。<br/><br/><pre>please input1 
please input2 
your input is aaa</pre><br/>これまでちゃんと理解せずにいたのですが、混乱しています。<br/><br/><code>getLine</code>がlazyではないから評価された時点で入力待ち状態になる、と考えると納得できそうですが、<br/>そもそも <code>getLine</code>  が評価されるのは「please input2」 を出力した後なのでは？<br/>たぶん「遅延評価」「式を評価する」ということの意味を正確に理解できていないと思うのですが、どなたかご教示いただけないでしょうか。</div>
          <a class="link-to-replies" href="22/1666062034.575279.html">... Replies ...</a>
        </div>
      </div>
      <div class="event" id="message-1666147001.076179">
        <div class="content">
          <div class="summary">
            <div class="user">mochizuki</div>
            <div class="date"><a class="date" href="#message-1666147001.076179">2022-10-19 11:36:41 +0900</a></div>
          </div>
          <div class="description">@mochizuki has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1666689195.737389">
        <div class="content">
          <div class="summary">
            <div class="user">Yoshikuni Kato</div>
            <div class="date"><a class="date" href="#message-1666689195.737389">2022-10-25 18:13:15 +0900</a></div>
          </div>
          <div class="description">\</div>
        </div>
      </div>
      <div class="event" id="message-1666822096.525419">
        <div class="content">
          <div class="summary">
            <div class="user">gnkm</div>
            <div class="date"><a class="date" href="#message-1666822096.525419">2022-10-27 07:08:16 +0900</a></div>
          </div>
          <div class="description">@gnkm has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1667060090.805199">
        <div class="content">
          <div class="summary">
            <div class="user">Jake Lengyel</div>
            <div class="date"><a class="date" href="#message-1667060090.805199">2022-10-30 01:14:50 +0900</a></div>
          </div>
          <div class="description">@Jake Lengyel has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1667135722.364259">
        <div class="content">
          <div class="summary">
            <div class="user">toyboot4e</div>
            <div class="date"><a class="date" href="#message-1667135722.364259">2022-10-30 22:15:22 +0900</a></div>
          </div>
          <div class="description">こんばんは。 <a href='https://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours'>Write Yourself a Scheme in 48 hours</a> をやっています。記事中では <code>String</code> が使用されていますが、代わりに <code>Text</code> (データ型) を使ってみたいと思います。</div>
        </div>
      </div>
      <div class="event" id="message-1667135853.108099">
        <div class="content">
          <div class="summary">
            <div class="user">toyboot4e</div>
            <div class="date"><a class="date" href="#message-1667135853.108099">2022-10-30 22:17:33 +0900</a></div>
          </div>
          <div class="description">ただ実際使おうにも、 1 文字を表すのに <code>Char</code> を使うべきか <code>Text.singleton</code> かなど迷う点が多くありそうです。</div>
          <a class="link-to-replies" href="22/1667135853.108099.html">... Replies ...</a>
        </div>
      </div>
      <div class="event" id="message-1667135922.740229">
        <div class="content">
          <div class="summary">
            <div class="user">toyboot4e</div>
            <div class="date"><a class="date" href="#message-1667135922.740229">2022-10-30 22:18:42 +0900</a></div>
          </div>
          <div class="description">(そのためインプットが欲しいと思います)。 <code>Text</code> と <code>Parsec</code> を使ったおすすめのリポジトリなどあれば、お聞かせ願えますでしょうか :eyes:</div>
        </div>
      </div>
      <div class="event" id="message-1667175686.852589">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1667175686.852589">2022-10-31 09:21:26 +0900</a></div>
          </div>
          <div class="description">@ has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1667220359.249549">
        <div class="content">
          <div class="summary">
            <div class="user">toyboot4e</div>
            <div class="date"><a class="date" href="#message-1667220359.249549">2022-10-31 21:45:59 +0900</a></div>
          </div>
          <div class="description">意外とリポジトリが見つかりました (<https://github.com/search?l=Haskell&amp;q=scheme+Data.Text+parsec&amp;type=Code|scheme>, <a href='https://github.com/search?l=Haskell&amp;q=lox+Data.Text&amp;type=Code'>lox</a>) 。 <code>String</code> をパースして <code>Text</code> で保存するみたいなものが多い気がします。 Parsec で <code>String</code> ではなく  <code>Text</code> を受け取ることは珍しいのでしょうか……？　よくあることなら探してみたいと思います :pray:</div>
        </div>
      </div>
      <div class="event" id="message-1667220676.193419">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1667220676.193419">2022-10-31 21:51:16 +0900</a></div>
          </div>
          <div class="description">えっと、ご所望のparsecを使ったものではないですが、パーサーコンビネーターの初歩的な概念を学ぶために、 <a href='https://www.lambdanote.com/products/haskell'>https://www.lambdanote.com/products/haskell</a> の第13章などの本を読むのがおすすめです。Haskellの世界にはparsec以外にも、もっと新しいmegaparsecなどいろいろなパーサーコンビネーターがありますが、基本的な使い方や考え方は全く変わらないので、サンプルとしては十分だと思います。 <code>Text</code> でやろうと <code>String</code> でやろうとも基本は変わりませんし。</div>
        </div>
      </div>
      <div class="event" id="message-1667222218.239849">
        <div class="content">
          <div class="summary">
            <div class="user">toyboot4e</div>
            <div class="date"><a class="date" href="#message-1667222218.239849">2022-10-31 22:16:58 +0900</a></div>
          </div>
          <div class="description">そうですね、そちらの本も持っているのでじっくり読んでみます。ありがとうございます。</div>
        </div>
      </div>
      <div class="event" id="message-1667222331.007019">
        <div class="content">
          <div class="summary">
            <div class="user">toyboot4e</div>
            <div class="date"><a class="date" href="#message-1667222331.007019">2022-10-31 22:18:51 +0900</a></div>
          </div>
          <div class="description">と思いきや、今コンパイルが通りました。 <code>Text.ParseCombinators.Parsec</code> の代わりに <code>Text.Parsec</code> や <code>Text.Parsec.Text</code> を import したら良かったみたいです……？<br/>大分怪しいですが進んでみます……！ ()</div>
          <a class="link-to-replies" href="22/1667222331.007019.html">... Replies ...</a>
        </div>
      </div>
      <div class="event" id="message-1667297024.821029">
        <div class="content">
          <div class="summary">
            <div class="user">t-shibata</div>
            <div class="date"><a class="date" href="#message-1667297024.821029">2022-11-01 19:03:44 +0900</a></div>
          </div>
          <div class="description">パラメータ多相とアドホック多相の違いについて質問させてください。<br/>自分の理解では、パラメータ多相は「いろんな型から利用でき、全く同じ動きをする多相性」で、アドホック多相は「いろんな型から利用でき、それぞれで動きが異なる多相性」のことだと思っています。<br/>この認識はあっていますでしょうか？<br/><br/>また、上記の認識と今まで見てきた情報を総括して個人的なイメージとして「Haskellはパラメータ多相、JavaとかC++などのクラスベースオブジェクト指向はアドホック多相」という風に思っていました。（こういう紹介をしていた情報源もどこかで見たことがあった気がしています。）<br/>ですが、例えばジェネリクスを使って型Aの変数をそのまま返す関数を作れば、これはパラメータ多相っぽいのでは？と思いました。<br/>また、`fmap`はそれを実装したい型ごとに <code>instance</code> 構文でそれぞれの型用の動きを記述するため、`fmap`はアドホック多相っぽいような気がしています。<br/>そうなりますとパラメータ多相やアドホック多相は関数型やオブジェクト指向などの考え方とは独立したものになる感じでしょうか？</div>
          <a class="link-to-replies" href="22/1667297024.821029.html">... Replies ...</a>
        </div>
      </div>
      <div class="event" id="message-1667385234.800059">
        <div class="content">
          <div class="summary">
            <div class="user">すみだわら</div>
            <div class="date"><a class="date" href="#message-1667385234.800059">2022-11-02 19:33:54 +0900</a></div>
          </div>
          <div class="description">@すみだわら has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1667450855.528669">
        <div class="content">
          <div class="summary">
            <div class="user">Mizutani</div>
            <div class="date"><a class="date" href="#message-1667450855.528669">2022-11-03 13:47:35 +0900</a></div>
          </div>
          <div class="description">@Mizutani has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1667609010.131749">
        <div class="content">
          <div class="summary">
            <div class="user">U049ZTT7M8R</div>
            <div class="date"><a class="date" href="#message-1667609010.131749">2022-11-05 09:43:30 +0900</a></div>
          </div>
          <div class="description">@U049ZTT7M8R has joined the channel</div>
        </div>
      </div>
    </div>
    <div class="ui pagination menu">
      <a href="../../html/CR2TETE5R/21.html" class="item">Previous</a>
      <a href="../../" class="item">Top</a>
    </div>
  </div>
</body>
</html>
