[
    {
        "ts": "1755395762.776069",
        "text": "質問失礼します。\nNixOSでHaskellの開発環境の構築をしようとして、つまずいています。\nvscodeのHaskellの拡張機能を正常に動かすことができません。\nghcupを追加すれば良さそうなのですが、追加しようとすると` Package ‘ghcup-0.1.50.2’ in (中略しています) is marked as broken` となってしまい、ghcupを追加できません。\ndevShellを利用した環境でvscodeのhaskellの拡張機能が正常に動作する開発環境を構築したいです。\n単にflake.nixに適当な依存を追加する方法、haskell.nixを利用する方法などいろいろあると思いますが、どのような方法でも教えていただけますと助かります。\n(Nixのコミュニティに質問するべきなのかもしれないのですが、Haskellの知識が足りないのも原因の一つになっていそうなので、こちらで質問させていただきました。)\n\n現状のflake.nixは以下のようになっています。\n以下のflakeを配置したディレクトリで、`stack new sample`で`sample`プロジェクトを作成し、環境を構築する方法を試しました。\n```{\n  description = \"haskell-mytutorial\";\n  inputs = {\n    nixpkgs.url = \"github:NixOS/nixpkgs/nixpkgs-unstable\";\n    flake-utils.url = \"github:numtide/flake-utils\";\n  };\n\n  outputs =\n    inputs:\n    inputs.flake-utils.lib.eachDefaultSystem (\n      system:\n      let\n        pkgs = inputs.nixpkgs.legacyPackages.${system};\n      in\n      {\n        devShells.default = pkgs.mkShell {\n          packages = with pkgs; [\n            stack\n            haskell-language-server\n          ];\n        };\n      }\n    );\n}```\nHaskellの拡張機能が出力しているログ？は以下になります。\n```2025-08-16 15:55:50.8370000 [client] INFO Finding haskell-language-server\n2025-08-16 15:55:50.8380000 [client] INFO Checking for ghcup installation\n2025-08-16 15:55:50.8470000 [client] INFO probing for GHCup binary\n2025-08-16 15:55:50.8560000 [client] WARN ghcup at /home/hello/.ghcup/bin/ghcup does not exist```",
        "type": "message",
        "user": "U09BGLQGABA"
    },
    {
        "ts": "1755491899.192549",
        "text": "仕事でhaskellをNix Flakesで管理していますが、少なくともghcupは使っていません。\nnix側でコンパイラのバージョンなどは管理できるので、ghcupは不要だと判断していて、実際不要でした。\n以前私が試行錯誤したメモは私のブログに書いています。\n<https://www.ncaq.net/2025/01/28/22/17/39/|Haskell開発環境にNix Flakesを使う - ncaq>\n私はVSCodeは使わなくてEmacsを使っているのですが、チームメンバーはある程度正常にVSCodeを使えているようです",
        "type": "message",
        "user": "U57CUMWQ6"
    },
    {
        "ts": "1755519490.256579",
        "text": "教えていただきありがとうございます！\nncaqさんの記事を参考にしつつ、haskell.nixを利用する方向で試してみます。",
        "type": "message",
        "user": "U09BGLQGABA"
    },
    {
        "ts": "1755605563.685709",
        "text": "蛇足かもしれないですが、自分は VS Code を Nix Flakes の devShells の環境で動くようにするために direnv 拡張を使っています\n<https://marketplace.visualstudio.com/items?itemName=mkhl.direnv>",
        "type": "message",
        "user": "U4L0B71L1"
    },
    {
        "ts": "1755771026.535799",
        "text": "kakkun61さんもアドバイスありがとうございます！\ndirenv便利ですよね。私もいつも利用させてもらっています。",
        "type": "message",
        "user": "U09BGLQGABA"
    },
    {
        "ts": "1756216271.127479",
        "text": "haskell.nixを使って環境構築はできませんでしたが、vscodeのHaskellの拡張機能が正常に動作するようなflake.nixの用意とvscodeの設定をすることができました。\nncaqさん、kakkun61さん、親切に教えてくださり、ありがとうございました！",
        "type": "message",
        "user": "U09BGLQGABA"
    }
]