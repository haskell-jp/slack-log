<!DOCTYPE html><html><head><meta charset="utf-8"><title>haskell-jp / questions #91</title><link rel="stylesheet" href="../../main.css" type="text/css" media="screen"></head><body><div class="ui container"><h1>haskell-jp / questions #91</h1><div class="pager ui pagination menu"><a href="../../html/C5666B6BB/90.html" class="pager__previous item">Previous</a><a href="../../" class="pager__top item">Top</a></div><div class="message_list ui feed"><div class="message event" id="message-1601935082.044900"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1601935082.044900">2020-10-06&nbsp;06:58:02 +0900</a></div></div><div class="message__body description">あるいは、<br/><pre>instance MonadFail m =&gt; AWST' env m where
  fail = ...</pre><br/>というインスタンスなら汎用性があるのでそれをPRしてあげるか。</div></div></div><div class="message event" id="message-1601935219.045100"><div class="content"><div class="summary"><div class="message__header user">ncaq</div><div class="message__timestamp date"><a class="date" href="#message-1601935219.045100">2020-10-06&nbsp;07:00:19 +0900</a></div></div><div class="message__body description">amazonka的にはMonadCatch系を使いたいようなので本流には入らなさそうな気がしますね</div></div></div><div class="message event" id="message-1601935364.045300"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1601935364.045300">2020-10-06&nbsp;07:02:44 +0900</a></div></div><div class="message__body description">なるほど <code>streaming</code> の方はサードパーティーか... じゃあおかしいのは<br/>amazonka-s3-streaming のほうですね... ざっとソース読んだ感じ別に <code>fail</code> が絶対に必要な展開ではないんだよなぁ... <a href='https://hackage.haskell.org/package/amazonka-s3-streaming-1.1.0.0/docs/src/Network.AWS.S3.StreamingUpload.html#concurrentUpload'>https://hackage.haskell.org/package/amazonka-s3-streaming-1.1.0.0/docs/src/Network.AWS.S3.StreamingUpload.html#concurrentUpload</a></div></div></div><div class="message event" id="message-1601935414.045500"><div class="content"><div class="summary"><div class="message__header user">ncaq</div><div class="message__timestamp date"><a class="date" href="#message-1601935414.045500">2020-10-06&nbsp;07:03:34 +0900</a></div></div><div class="message__body description">作者も修正したさそうなので修正投げようかと思ったのですが型が大きく変動しそうなのでちょっと気後れしちゃいますね</div></div></div><div class="message event" id="message-1601935898.045800"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1601935898.045800">2020-10-06&nbsp;07:11:38 +0900</a></div></div><div class="message__body description"><code>MonadFail</code> を <code>MonadThrow</code> に変えるか、 <code>SomeException</code> で <code>fail</code> で投げるはずの例外を包んであげればいいかな、と思いましたが、そもそも、すでに <code>m</code> は <code>MonadUnliftIO m</code> （ <code>MonadIO</code> のサブクラス）が実装済みなワケですから <code>liftIO fail</code> にすればそこで賄えるかと（多分作者の気持ちはそっちの方が近いし）<br/><br/>それに、仮に変わるとしてもそういうときのためのHPVPなんですから、何も恐れる必要はないと思いますよ！はっきりいって使い物にならないような設計にしてしまっているので恐れず変えちゃいましょう。</div></div></div><div class="message event" id="message-1601936028.046000"><div class="content"><div class="summary"><div class="message__header user">ncaq</div><div class="message__timestamp date"><a class="date" href="#message-1601936028.046000">2020-10-06&nbsp;07:13:48 +0900</a></div></div><div class="message__body description">なるほどfailをliftIOする方法がありましたか<br/>考えてみます</div></div></div><div class="message event" id="message-1601936343.046300"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1601936343.046300">2020-10-06&nbsp;07:19:03 +0900</a></div></div><div class="message__body description">ちなみに、 <code>MonadThrow</code> に変える方法に抵抗がある理由が「例外作らなきゃいけない」でしたら <code>throwString</code> の使用をご検討ください。<br/><a href='https://www.stackage.org/haddock/lts-16.17/unliftio-0.2.13/UnliftIO-Exception.html#v:throwString'>https://www.stackage.org/haddock/lts-16.17/unliftio-0.2.13/UnliftIO-Exception.html#v:throwString</a><br/>unliftioに入っているので新たに依存関係を足す必要もありません。</div></div></div><div class="message event" id="message-1601936564.046600"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1601936564.046600">2020-10-06&nbsp;07:22:44 +0900</a></div></div><div class="message__body description">続けて済みません「作者が痛みとして思っている」という情報はどこらですか？ <a href='https://github.com/axman6/amazonka-s3-streaming/issues'>https://github.com/axman6/amazonka-s3-streaming/issues</a> をざっと見ましたがそれらしいものはないみたいで。どういう論点で <code>MonadFail</code> のままにしているのか気になります。</div></div></div><div class="message event" id="message-1601936666.046900"><div class="content"><div class="summary"><div class="message__header user">ncaq</div><div class="message__timestamp date"><a class="date" href="#message-1601936666.046900">2020-10-06&nbsp;07:24:26 +0900</a></div></div><div class="message__body description">パフォーマンス改善のpull requestsへのコメントで<br/>作者「MonadFail辛いしやめたい」<br/>PR作成者「それこのPRで扱うことではないのでは」<br/>みたいなやり取りがありました</div></div></div><div class="message event" id="message-1601942234.047100"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1601942234.047100">2020-10-06&nbsp;08:57:14 +0900</a></div></div><div class="message__body description">MonadFailじゃなくてMonadAWSの話みたいですよ！<br/><a href='https://github.com/axman6/amazonka-s3-streaming/pull/20'>https://github.com/axman6/amazonka-s3-streaming/pull/20</a></div></div></div><div class="message event" id="message-1601942323.047400"><div class="content"><div class="summary"><div class="message__header user">igrep</div><div class="message__timestamp date"><a class="date" href="#message-1601942323.047400">2020-10-06&nbsp;08:58:43 +0900</a></div></div><div class="message__body description">該当するスレッドはこっちか<br/><a href='https://github.com/axman6/amazonka-s3-streaming/pull/22#discussion_r397516136'>https://github.com/axman6/amazonka-s3-streaming/pull/22#discussion_r397516136</a></div></div></div><div class="message event" id="message-1602001113.047700"><div class="content"><div class="summary"><div class="message__header user">U01CF0YMQTT</div><div class="message__timestamp date"><a class="date" href="#message-1602001113.047700">2020-10-07&nbsp;01:18:33 +0900</a></div></div><div class="message__body description">@U01CF0YMQTT has joined the channel</div></div></div></div><div class="pager ui pagination menu"><a href="../../html/C5666B6BB/90.html" class="pager__previous item">Previous</a><a href="../../" class="pager__top item">Top</a></div></div></body></html>