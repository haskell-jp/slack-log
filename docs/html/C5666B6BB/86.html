<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>haskell-jp / questions #86</title>
<link rel="stylesheet" href="../../main.css" type="text/css" media="screen">
</head>
<body>
  <div class="ui container">
    <h1>haskell-jp / questions #86</h1>
    <div class="ui pagination menu">
      <a href="../../html/C5666B6BB/85.html" class="item">Previous</a>
      <a href="../../" class="item">Top</a>
      <a href="../../html/C5666B6BB/87.html" class="item">Next</a>
    </div>
    <div class="ui feed">
      <div class="event" id="message-1591238276.011000">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1591238276.011000">2020-06-04 11:37:56 +0900</a></div>
          </div>
          <div class="description">メンテが止まってるのはやっぱ避けた方がいいと思いますよ。<br/>別に学習用途で使う分には全く問題ないと思いますが、真面目に長期間運用するアプリケーションに採用するのは避けた方がいいと思います。</div>
        </div>
      </div>
      <div class="event" id="message-1591241241.011200">
        <div class="content">
          <div class="summary">
            <div class="user">cj.bc-sd</div>
            <div class="date"><a class="date" href="#message-1591241241.011200">2020-06-04 12:27:21 +0900</a></div>
          </div>
          <div class="description">成程了解です、ありがとうございます<br/>実はweb開発自体をあまり経験してないので、その学習も兼ねて一通りやってみて、実際に使う時には他のものを考えます！</div>
        </div>
      </div>
      <div class="event" id="message-1591320095.012700">
        <div class="content">
          <div class="summary">
            <div class="user">koji.ishimoto</div>
            <div class="date"><a class="date" href="#message-1591320095.012700">2020-06-05 10:21:35 +0900</a></div>
          </div>
          <div class="description">@koji.ishimoto has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1591463645.019400">
        <div class="content">
          <div class="summary">
            <div class="user">dex10619</div>
            <div class="date"><a class="date" href="#message-1591463645.019400">2020-06-07 02:14:05 +0900</a></div>
          </div>
          <div class="description"><a href='https://wiki.haskell.org/GHC/Type_families'>https://wiki.haskell.org/GHC/Type_families</a><br/>の記事を読んでいて見慣れない記号が出てきました。<br/><br/><br/><pre>sumCollects :: (Collects c1, Collects c2, Elem c1 ~ Elem c2) =&gt; c1 -&gt; c2 -&gt; c2
sumCollects c1 c2 = foldr insert c2 (toList c1)</pre><br/>上記の「Elem c1」と「Elem c2」の間の「〜」は何を意味しているのでしょうか。<br/>ちなみに、上記のElemはtype familyにより、以下のように宣言されています。<br/><br/><pre>class Collects ce where
  type Elem ce
  empty  :: ce
  insert :: Elem ce -&gt; ce -&gt; ce
  member :: Elem ce -&gt; ce -&gt; Bool
  toList :: ce -&gt; [Elem ce]</pre><br/>通常の型制約とは異なることを示す記号だとは推測しますが、ググってもパッとは出てこず。。</div>
        </div>
      </div>
      <div class="event" id="message-1591463915.019500">
        <div class="content">
          <div class="summary">
            <div class="user">ncaq</div>
            <div class="date"><a class="date" href="#message-1591463915.019500">2020-06-07 02:18:35 +0900</a></div>
          </div>
          <div class="description">等しいことを表してたはずです(あまり自信がない)</div>
        </div>
      </div>
      <div class="event" id="message-1591464803.019700">
        <div class="content">
          <div class="summary">
            <div class="user">dex10619</div>
            <div class="date"><a class="date" href="#message-1591464803.019700">2020-06-07 02:33:23 +0900</a></div>
          </div>
          <div class="description">@ncaq<br/>回答ありがとうございます！<br/>なるほど！確かに<br/><br/><pre>sumCollects c1 c2 = foldr insert c2 (toList c1)</pre><br/>で、c1の要素をc2にinsertしているので、辻褄が合いそうです。</div>
        </div>
      </div>
      <div class="event" id="message-1591464956.019900">
        <div class="content">
          <div class="summary">
            <div class="user">ncaq</div>
            <div class="date"><a class="date" href="#message-1591464956.019900">2020-06-07 02:35:56 +0900</a></div>
          </div>
          <div class="description">個人的な実用では<br/><pre>PersistEntityBackend val ~ SqlBackend</pre><br/>とかでPersistentのバックエンドがSQLであるとかの確認でよく見ますね</div>
        </div>
      </div>
      <div class="event" id="message-1591465582.020200">
        <div class="content">
          <div class="summary">
            <div class="user">dex10619</div>
            <div class="date"><a class="date" href="#message-1591465582.020200">2020-06-07 02:46:22 +0900</a></div>
          </div>
          <div class="description">Equality Constraintsというんですね:smile:<br/><a href='https://downloads.haskell.org/~ghc/8.0.2/docs/html/users_guide/glasgow_exts.html#equality-constraints'>https://downloads.haskell.org/~ghc/8.0.2/docs/html/users_guide/glasgow_exts.html#equality-constraints</a><br/><br/>@ncaq さんのおかげで検索できました！</div>
        </div>
      </div>
      <div class="event" id="message-1591476138.020700">
        <div class="content">
          <div class="summary">
            <div class="user">kakkun61</div>
            <div class="date"><a class="date" href="#message-1591476138.020700">2020-06-07 05:42:18 +0900</a></div>
          </div>
          <div class="description">Haskell (GHC) で記号を調べるときは Haskell Symbol Search Cheatsheet が便利です<br/><a href='https://github.com/takenobu-hs/haskell-symbol-search-cheatsheet'>https://github.com/takenobu-hs/haskell-symbol-search-cheatsheet</a></div>
        </div>
      </div>
      <div class="event" id="message-1591483065.021600">
        <div class="content">
          <div class="summary">
            <div class="user">dex10619</div>
            <div class="date"><a class="date" href="#message-1591483065.021600">2020-06-07 07:37:45 +0900</a></div>
          </div>
          <div class="description">@kakkun61 <br/>ありがとうございます！</div>
        </div>
      </div>
      <div class="event" id="message-1591689971.025300">
        <div class="content">
          <div class="summary">
            <div class="user">naohaq</div>
            <div class="date"><a class="date" href="#message-1591689971.025300">2020-06-09 17:06:11 +0900</a></div>
          </div>
          <div class="description">マトモな性能の疑似乱数ライブラリって現状だとmwc-randomしか選択肢ないんでしょうか？</div>
        </div>
      </div>
      <div class="event" id="message-1591692885.027200">
        <div class="content">
          <div class="summary">
            <div class="user">cutsea110</div>
            <div class="date"><a class="date" href="#message-1591692885.027200">2020-06-09 17:54:45 +0900</a></div>
          </div>
          <div class="description"><pre>$ ghci
GHCi, version 8.6.5: <http://www.haskell.org/ghc/>  :? for help
Prelude&gt; let x = 123
Prelude&gt; return (x :: Int, x :: Float)
(123,123.0)</pre><br/>という風にghciだと <code>x :: Num a =&gt; a</code> なのから (x, x) で <code>Int</code> と <code>Float</code> のタプルにできるんですが、<br/><pre>$ cat test.hs
test = do
  let x = 123
  return (x :: Int, x :: Float)
$ ghci
Prelude&gt; :load "test.hs"
[1 of 1] Compiling Main             ( test.hs, interpreted )

test.hs:3:21: error:
    • Couldn't match expected type 'Float' with actual type 'Int'
    • In the expression: x :: Float
      In the first argument of 'return', namely '(x :: Int, x :: Float)'
      In a stmt of a 'do' block: return (x :: Int, x :: Float)
  |
3 |   return (x :: Int, x :: Float)
  |                     ^
Failed, no modules loaded.
Prelude&gt; :set
options currently set: none.
base language is: Haskell2010
with the following modifiers:
  -XNoDatatypeContexts
  -XNondecreasingIndentation
GHCi-specific dynamic flag settings:
other dynamic, non-language, flag settings:
  -fexternal-dynamic-refs
  -fignore-optim-changes
  -fignore-hpc-changes
  -fimplicit-import-qualified
warning settings:
Prelude&gt;</pre><br/>ってなるのなんででしょう?</div>
        </div>
      </div>
      <div class="event" id="message-1591693393.027500">
        <div class="content">
          <div class="summary">
            <div class="user">naohaq</div>
            <div class="date"><a class="date" href="#message-1591693393.027500">2020-06-09 18:03:13 +0900</a></div>
          </div>
          <div class="description"><pre>test :: IO (Int,Double)
test = do
  let { x :: Num a =&gt; a ; x = 1 }
  let y = (x,x) :: (Int,Double)
  return y</pre><br/>ならいけましたよ</div>
        </div>
      </div>
      <div class="event" id="message-1591694989.027700">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1591694989.027700">2020-06-09 18:29:49 +0900</a></div>
          </div>
          <div class="description">私が知る限りでは、mwc-randomだけだったと思いますね...<br/>もっと詳しい人が答えるべき泣きもしますが、以前（多分一年ぐらい前）探したときはそんな感じでした。</div>
        </div>
      </div>
      <div class="event" id="message-1591695353.028000">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1591695353.028000">2020-06-09 18:35:53 +0900</a></div>
          </div>
          <div class="description">これも直接の回答になってなくて恐縮ですが、案の定 <code>NoMonomorphismRestriction</code> を有効にしたらどの場合でもエラーになりませんでしたね。</div>
        </div>
      </div>
      <div class="event" id="message-1591695425.029300">
        <div class="content">
          <div class="summary">
            <div class="user">cutsea110</div>
            <div class="date"><a class="date" href="#message-1591695425.029300">2020-06-09 18:37:05 +0900</a></div>
          </div>
          <div class="description">おー、ありがとうございます <blockquote>@naohaq @igrep </blockquote></div>
        </div>
      </div>
      <div class="event" id="message-1591695616.032200">
        <div class="content">
          <div class="summary">
            <div class="user">cutsea110</div>
            <div class="date"><a class="date" href="#message-1591695616.032200">2020-06-09 18:40:16 +0900</a></div>
          </div>
          <div class="description">単相性制限に引っかかるからなのか。構文についてもいつのまにか勘違いしてそう…</div>
        </div>
      </div>
      <div class="event" id="message-1591695755.032400">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1591695755.032400">2020-06-09 18:42:35 +0900</a></div>
          </div>
          <div class="description"><a href='https://wiki.haskell.org/Monomorphism_restriction'>https://wiki.haskell.org/Monomorphism_restriction</a><br/>あー、やっぱり、<br/><blockquote>The restriction is turned on by default in compiled modules, and turned off by default at the GHCi prompt (since GHC 7.8.1).</blockquote>とありますね！</div>
        </div>
      </div>
      <div class="event" id="message-1591700377.033300">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591700377.033300">2020-06-09 19:59:37 +0900</a></div>
          </div>
          <div class="description"><a href='https://alexey.kuleshevi.ch/blog/2019/12/21/random-benchmarks/'>https://alexey.kuleshevi.ch/blog/2019/12/21/random-benchmarks/</a> がよくまとまっています</div>
        </div>
      </div>
      <div class="event" id="message-1591700915.036900">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591700915.036900">2020-06-09 20:08:35 +0900</a></div>
          </div>
          <div class="description">もう解決済みでしょうか？<br/><br/><blockquote>ghcのperformGCはGCの完了まで待たずに、実行をブロックしないものと思っていますが</blockquote><br/>これはnon-moving GCの話でしょうか？あとで時間があるときにコードを見てみようと思うのですが、デフォルトのGCはSTWなのでブロックすると思います。</div>
        </div>
      </div>
      <div class="event" id="message-1591726146.037300">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1591726146.037300">2020-06-10 03:09:06 +0900</a></div>
          </div>
          <div class="description">ありがとうございます。<br/>まだ解決してなかったです。<br/>ちょっとわかったのはFFIの場合はcのfinalizerはGC中に、haskellのfinalizerだとGCとは別のスレッドで実行されるのですね。<br/><a href='http://blog.ezyang.com/2014/05/the-cost-of-weak-pointers-and-finalizers-in-ghc/'>http://blog.ezyang.com/2014/05/the-cost-of-weak-pointers-and-finalizers-in-ghc/</a><br/>それなのでブロックしてないように見えていたというのはありました。</div>
        </div>
      </div>
      <div class="event" id="message-1591727698.037500">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1591727698.037500">2020-06-10 03:34:58 +0900</a></div>
          </div>
          <div class="description">performGC-&gt;scheduleDoGC-&gt;GarbageCollect<br/>doIdleGCWork-&gt;runSomeFinalizers-&gt;runCFinalizers<br/>と呼ばれていますが、cのファイナライザを呼んでいるのはscheduleDoGCのdoIdleGCWorkですかね。</div>
        </div>
      </div>
      <div class="event" id="message-1591727837.037700">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1591727837.037700">2020-06-10 03:37:17 +0900</a></div>
          </div>
          <div class="description">GarbageCollectの前後で呼んでいますね。<br/>performGCを一回呼ぶだけだとすぐにcのファイナライザは呼ばれなかったりしますか？<br/><a href='https://gitlab.haskell.org/ghc/ghc/-/blob/master/rts/Schedule.c#L1844-1862'>https://gitlab.haskell.org/ghc/ghc/-/blob/master/rts/Schedule.c#L1844-1862</a></div>
        </div>
      </div>
      <div class="event" id="message-1591747827.038400">
        <div class="content">
          <div class="summary">
            <div class="user">naohaq</div>
            <div class="date"><a class="date" href="#message-1591747827.038400">2020-06-10 09:10:27 +0900</a></div>
          </div>
          <div class="description">ありがとうございます。mersenne-random-pure64 を使ったら異常に遅くてなんなんだこれ、と思っていたんですが、紹介していただいた記事( <a href='https://alexey.kuleshevi.ch/blog/2019/12/21/random-benchmarks/'>https://alexey.kuleshevi.ch/blog/2019/12/21/random-benchmarks/</a> )を読んだ限りだと、<br/><blockquote>As it turns out, `randomR` and consequently `random` are oblivious to the concrete type that they are generating and all of the integral numbers go through the arbitrary precision `Integer` in order to produce the value in a desired range.</blockquote><code>System.Random</code> の <code>randomR</code> を使うと乱数生成器のアルゴリズムに関係なくパフォーマンスが激しく落ちるということなんですかね。</div>
        </div>
      </div>
      <div class="event" id="message-1591776344.039500">
        <div class="content">
          <div class="summary">
            <div class="user">na4zagin3</div>
            <div class="date"><a class="date" href="#message-1591776344.039500">2020-06-10 17:05:44 +0900</a></div>
          </div>
          <div class="description">random は次バージョンで改善されるそうです<br/><a href='https://github.com/haskell/random/pull/61#issuecomment-633002711'>https://github.com/haskell/random/pull/61#issuecomment-633002711</a></div>
        </div>
      </div>
      <div class="event" id="message-1591796979.040000">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591796979.040000">2020-06-10 22:49:39 +0900</a></div>
          </div>
          <div class="description">Cファイナライザはmajor GCとidle GCのタイミングで実行されます。<br/><br/><a href='https://gitlab.haskell.org/ghc/ghc/-/blob/87102928cce33d9029ca4cc449dde6efc802b8ec/rts/Weak.c#L183-212'>https://gitlab.haskell.org/ghc/ghc/-/blob/87102928cce33d9029ca4cc449dde6efc802b8ec/rts/Weak.c#L183-212</a><br/>ここら辺の解説を読むとCファイナライザを呼ぶときに停止時間を短くするため、あらかじめ決められた数のファイナライザ（100個 <a href='https://gitlab.haskell.org/ghc/ghc/-/blob/87102928cce33d9029ca4cc449dde6efc802b8ec/rts/Weak.c#L218'>https://gitlab.haskell.org/ghc/ghc/-/blob/87102928cce33d9029ca4cc449dde6efc802b8ec/rts/Weak.c#L218</a>）を実行した時点で残りのファイナライザは次回のidle GCが呼ばれるまで遅延するようです。<br/><br/>runSomeFinalizersの引数allがtrueの場合はすべてのファイナライザを実行しますが、これはmajor GCが呼ばれるかRTSがexitするタイミングで呼ばれます。</div>
        </div>
      </div>
      <div class="event" id="message-1591796981.040300">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591796981.040300">2020-06-10 22:49:41 +0900</a></div>
          </div>
          <div class="description"><a href='https://gitlab.haskell.org/ghc/ghc/-/blob/87102928cce33d9029ca4cc449dde6efc802b8ec/rts/Schedule.c#L1846'>https://gitlab.haskell.org/ghc/ghc/-/blob/87102928cce33d9029ca4cc449dde6efc802b8ec/rts/Schedule.c#L1846</a></div>
        </div>
      </div>
      <div class="event" id="message-1591797032.040600">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591797032.040600">2020-06-10 22:50:32 +0900</a></div>
          </div>
          <div class="description">従ってmajor GCを2回走らせてみてオブジェクトが解放されるか確認してみるといいかもしれません。</div>
        </div>
      </div>
      <div class="event" id="message-1591797321.040900">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591797321.040900">2020-06-10 22:55:21 +0900</a></div>
          </div>
          <div class="description"><a href='https://gitlab.haskell.org/ghc/ghc/issues/18239'>https://gitlab.haskell.org/ghc/ghc/issues/18239</a> ちなみに元のissueがcloseされているのは何故でしょうか？</div>
        </div>
      </div>
      <div class="event" id="message-1591797674.041200">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591797674.041200">2020-06-10 23:01:14 +0900</a></div>
          </div>
          <div class="description"><blockquote>従ってmajor GCを2回走らせてみてオブジェクトが解放されるか確認してみるといいかもしれません。</blockquote>よく読むとmajor/minor関係なくdoIdleGCWorkは呼ばれますね。minor GCだけでも良さそうです。ただ元のissueではcopying GCでは問題が起きていないように読めるのですが、doIdleGCWorkはcopying/non-moving関係なく呼ばれているので別の問題かもしれません。</div>
        </div>
      </div>
      <div class="event" id="message-1591868603.042300">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1591868603.042300">2020-06-11 18:43:23 +0900</a></div>
          </div>
          <div class="description"><a href='https://gitlab.haskell.org/ghc/ghc/-/merge_requests/3389'>https://gitlab.haskell.org/ghc/ghc/-/merge_requests/3389</a><br/>こっちがあるからクローズですかね</div>
        </div>
      </div>
      <div class="event" id="message-1591869765.045200">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1591869765.045200">2020-06-11 19:02:45 +0900</a></div>
          </div>
          <div class="description">元のissueがmasterで直ってから閉じた方がいいと思います。特にGHC開発者は人手が少なくて忙しそうなので、closeされると問題が見落とされてしまいそう。</div>
        </div>
      </div>
      <div class="event" id="message-1591871690.047500">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1591871690.047500">2020-06-11 19:34:50 +0900</a></div>
          </div>
          <div class="description">リンクありがとうございます<br/>copying gcだと問題おきなかったのですが<br/>簡単なケースだと問題が再現できなかったのでどう攻めたものかと悩んでます</div>
        </div>
      </div>
      <div class="event" id="message-1591905426.047700">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1591905426.047700">2020-06-12 04:57:06 +0900</a></div>
          </div>
          <div class="description"><a href='https://github.com/junjihashimoto/gc-test/blob/master/Main.hs#L34'>https://github.com/junjihashimoto/gc-test/blob/master/Main.hs#L34</a><br/>ここで一回よぶか二回よぶかで結果が変わってきますね。</div>
        </div>
      </div>
      <div class="event" id="message-1592038671.048100">
        <div class="content">
          <div class="summary">
            <div class="user">yskbsk13</div>
            <div class="date"><a class="date" href="#message-1592038671.048100">2020-06-13 17:57:51 +0900</a></div>
          </div>
          <div class="description">@yskbsk13 has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1592467725.054100">
        <div class="content">
          <div class="summary">
            <div class="user">benzene.chlorobenzene</div>
            <div class="date"><a class="date" href="#message-1592467725.054100">2020-06-18 17:08:45 +0900</a></div>
          </div>
          <div class="description">@benzene.chlorobenzene has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1592486441.054300">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1592486441.054300">2020-06-18 22:20:41 +0900</a></div>
          </div>
          <div class="description">nonmoving gcだとprofileとれないですね。だれかebpfでprofileとった例とかあるといいのですが。</div>
        </div>
      </div>
      <div class="event" id="message-1592486491.054500">
        <div class="content">
          <div class="summary">
            <div class="user">junji.hashimoto</div>
            <div class="date"><a class="date" href="#message-1592486491.054500">2020-06-18 22:21:31 +0900</a></div>
          </div>
          <div class="description">funccountでperformGCいれてもでてこないですね。たぶん使い方が間違っているのだと思いますが。</div>
        </div>
      </div>
      <div class="event" id="message-1592553779.055700">
        <div class="content">
          <div class="summary">
            <div class="user">kakkun61</div>
            <div class="date"><a class="date" href="#message-1592553779.055700">2020-06-19 17:02:59 +0900</a></div>
          </div>
          <div class="description">relational record でプレースホールダーが <code>?</code> じゃなくて <code>$1</code>, <code>$2</code> になるオプションってありましたっけ？</div>
        </div>
      </div>
      <div class="event" id="message-1592553812.055800">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1592553812.055800">2020-06-19 17:03:32 +0900</a></div>
          </div>
          <div class="description">少なくとも私がいじってた頃はなかったですね...<br/>SQL標準じゃないから、でしたっけ？ @khibino</div>
        </div>
      </div>
      <div class="event" id="message-1592556928.058800">
        <div class="content">
          <div class="summary">
            <div class="user">khibino</div>
            <div class="date"><a class="date" href="#message-1592556928.058800">2020-06-19 17:55:28 +0900</a></div>
          </div>
          <div class="description"><code>?</code> が SQL 標準かどうかは把握していないんですが、<br/>おおくの RDBMs ドライバがこの機能をサポートしているのでそうしています。<br/><br/>PostgreSQL や MySQL だと、どちらも使えたりするんだろうか。</div>
        </div>
      </div>
      <div class="event" id="message-1592557764.060300">
        <div class="content">
          <div class="summary">
            <div class="user">cj.bc-sd</div>
            <div class="date"><a class="date" href="#message-1592557764.060300">2020-06-19 18:09:24 +0900</a></div>
          </div>
          <div class="description">Lensについて質問です<br/><code>over</code> の第二引数には <code>a -&gt; b</code> な関数をとると思うのですが、ここで <code>a -&gt; m b</code> (具体的には <code>a -&gt; IO b</code> )をとる関数というのは存在するのでしょうか<br/>Hoogleでもうまく検索できず…<br/><pre>over myLens &lt;$&gt; (ioAction) &lt;*&gt; data</pre><br/>という形でできないかなぁと思ったのですが、 <code>ioAction</code> はこの段階で評価されないのでできないよな…というところまで行きついて詰まりました</div>
        </div>
      </div>
      <div class="event" id="message-1592558842.060500">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1592558842.060500">2020-06-19 18:27:22 +0900</a></div>
          </div>
          <div class="description">実はLensそのものがそうなってるんですよ（実は全く同じ質問を随分前にここでして教わりました :sweat_smile:</div>
        </div>
      </div>
      <div class="event" id="message-1592558914.060700">
        <div class="content">
          <div class="summary">
            <div class="user">cj.bc-sd</div>
            <div class="date"><a class="date" href="#message-1592558914.060700">2020-06-19 18:28:34 +0900</a></div>
          </div>
          <div class="description"><code>over</code> だと <code>Asetter</code> を使っていて <code>Identify</code> に包まれている、ってとこをみたのですがそれと同じですか…?</div>
        </div>
      </div>
      <div class="event" id="message-1592559212.060900">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1592559212.060900">2020-06-19 18:33:32 +0900</a></div>
          </div>
          <div class="description">:point_down: の定義のとおり、<br/>その`Identity` を <code>Functor f =&gt; f</code>に一般化したのが <code>Lens</code> そのものなので、<br/><code>myLens ioAction data</code> でコンパイル通りませんか？<br/><pre>type Lens s t a b = forall f. Functor f =&gt; (a -&gt; f b) -&gt; s -&gt; f t </pre></div>
        </div>
      </div>
      <div class="event" id="message-1592559519.061100">
        <div class="content">
          <div class="summary">
            <div class="user">kakkun61</div>
            <div class="date"><a class="date" href="#message-1592559519.061100">2020-06-19 18:38:39 +0900</a></div>
          </div>
          <div class="description">標準の状態だと PostgreSQL の拡張問合せプロトコルだと <code>$n</code> だけみたいですね（設定で変えられるのかな<br/><br/><blockquote>use $1, $2, etc.<br/><a href='https://www.postgresql.org/docs/12/sql-prepare.html'>https://www.postgresql.org/docs/12/sql-prepare.html</a></blockquote>“etc.” とは</div>
        </div>
      </div>
      <div class="event" id="message-1592559545.061300">
        <div class="content">
          <div class="summary">
            <div class="user">cj.bc-sd</div>
            <div class="date"><a class="date" href="#message-1592559545.061300">2020-06-19 18:39:05 +0900</a></div>
          </div>
          <div class="description">あ、なるほど！！<br/>試してみます！</div>
        </div>
      </div>
      <div class="event" id="message-1592559668.061600">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1592559668.061600">2020-06-19 18:41:08 +0900</a></div>
          </div>
          <div class="description">過去自分で質問した時の記録を探していて気づいたのですが、 <a href='https://haskell.jp/slack-log/html/C5666B6BB/72.html#message-1570939612.018800'>https://haskell.jp/slack-log/html/C5666B6BB/72.html#message-1570939612.018800</a> といいよく私と同じ問題にハマりますね... :sweat_smile:<br/>この、containersパッケージの <code>State</code> の定義がおかしい問題も以前私も <a href='#C4M4TT8JJ'>random</a> で話題にしたことがありまして...</div>
        </div>
      </div>
      <div class="event" id="message-1592559879.062000">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1592559879.062000">2020-06-19 18:44:39 +0900</a></div>
          </div>
          <div class="description">$3, $4, $5, ... のことを指しているのでは <blockquote>.etc</blockquote></div>
        </div>
      </div>
      <div class="event" id="message-1592587072.062200">
        <div class="content">
          <div class="summary">
            <div class="user">kakkun61</div>
            <div class="date"><a class="date" href="#message-1592587072.062200">2020-06-20 02:17:52 +0900</a></div>
          </div>
          <div class="description">HDBC コンパチにするために ? 形式から $ 形式に変換する実装があったのを思い出したので切り出した<br/><a href='http://hackage.haskell.org/package/postgresql-placeholder-converter'>http://hackage.haskell.org/package/postgresql-placeholder-converter</a></div>
        </div>
      </div>
    </div>
    <div class="ui pagination menu">
      <a href="../../html/C5666B6BB/85.html" class="item">Previous</a>
      <a href="../../" class="item">Top</a>
      <a href="../../html/C5666B6BB/87.html" class="item">Next</a>
    </div>
  </div>
</body>
</html>
