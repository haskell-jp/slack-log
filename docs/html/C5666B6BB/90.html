<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>haskell-jp / questions #90</title>
<link rel="stylesheet" href="../../main.css" type="text/css" media="screen">
</head>
<body>
  <div class="ui container">
    <h1>haskell-jp / questions #90</h1>
    <div class="ui pagination menu">
      <a href="../../html/C5666B6BB/89.html" class="item">Previous</a>
      <a href="../../" class="item">Top</a>
      <a href="../../html/C5666B6BB/91.html" class="item">Next</a>
    </div>
    <div class="ui feed">
      <div class="event" id="message-1600500174.000400">
        <div class="content">
          <div class="summary">
            <div class="user">Izawa</div>
            <div class="date"><a class="date" href="#message-1600500174.000400">2020-09-19 16:22:54 +0900</a></div>
          </div>
          <div class="description">@Izawa has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1600571689.000600">
        <div class="content">
          <div class="summary">
            <div class="user">zaneli</div>
            <div class="date"><a class="date" href="#message-1600571689.000600">2020-09-20 12:14:49 +0900</a></div>
          </div>
          <div class="description">@zaneli has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1600584709.000800">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1600584709.000800">2020-09-20 15:51:49 +0900</a></div>
          </div>
          <div class="description">こんな感じの型って既存のパッケージにありますか？<br/><pre>data EList e a = End e | ECons a (EList e a)</pre><br/>リストの末尾に情報を1個付け加えたいのです。</div>
        </div>
      </div>
      <div class="event" id="message-1600584884.000900">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1600584884.000900">2020-09-20 15:54:44 +0900</a></div>
          </div>
          <div class="description">補足すると、こういう形のリストに対して、主に結合演算をしたいです。</div>
        </div>
      </div>
      <div class="event" id="message-1600585010.001100">
        <div class="content">
          <div class="summary">
            <div class="user">kakkun61</div>
            <div class="date"><a class="date" href="#message-1600585010.001100">2020-09-20 15:56:50 +0900</a></div>
          </div>
          <div class="description"><code>(List a, e)</code> の同型ということですか？</div>
        </div>
      </div>
      <div class="event" id="message-1600585095.001300">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1600585095.001300">2020-09-20 15:58:15 +0900</a></div>
          </div>
          <div class="description">だと思いますし、それでいいかな...</div>
        </div>
      </div>
      <div class="event" id="message-1600585857.001500">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1600585857.001500">2020-09-20 16:10:57 +0900</a></div>
          </div>
          <div class="description">と、思ったけど今回の問題に割と固有（でも一般化はできそう？）な気がしたので独自に作っちゃいます。詳しい事情はそのパッケージリリースしたとき書きます。</div>
        </div>
      </div>
      <div class="event" id="message-1600587771.003600">
        <div class="content">
          <div class="summary">
            <div class="user">Slackbot</div>
            <div class="date"><a class="date" href="#message-1600587771.003600">2020-09-20 16:42:51 +0900</a></div>
          </div>
          <div class="description">This message was deleted.</div>
        </div>
      </div>
      <div class="event" id="message-1600588064.003700">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1600588064.003700">2020-09-20 16:47:44 +0900</a></div>
          </div>
          <div class="description">もくもく会中の独り言であれば <a href='#CUPBC8WCE'>mokumoku-online</a> にお願いします！ :pray:</div>
        </div>
      </div>
      <div class="event" id="message-1600588499.003900">
        <div class="content">
          <div class="summary">
            <div class="user">kakkun61</div>
            <div class="date"><a class="date" href="#message-1600588499.003900">2020-09-20 16:54:59 +0900</a></div>
          </div>
          <div class="description">まっちがえた</div>
        </div>
      </div>
      <div class="event" id="message-1600593599.004500">
        <div class="content">
          <div class="summary">
            <div class="user">rl-king</div>
            <div class="date"><a class="date" href="#message-1600593599.004500">2020-09-20 18:19:59 +0900</a></div>
          </div>
          <div class="description">@rl-king has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1600609671.004600">
        <div class="content">
          <div class="summary">
            <div class="user">notogawa</div>
            <div class="date"><a class="date" href="#message-1600609671.004600">2020-09-20 22:47:51 +0900</a></div>
          </div>
          <div class="description"><code>Data.List.NonEmpty</code> では</div>
        </div>
      </div>
      <div class="event" id="message-1600609701.004800">
        <div class="content">
          <div class="summary">
            <div class="user">notogawa</div>
            <div class="date"><a class="date" href="#message-1600609701.004800">2020-09-20 22:48:21 +0900</a></div>
          </div>
          <div class="description">あ，違う型なのか</div>
        </div>
      </div>
      <div class="event" id="message-1600629095.005100">
        <div class="content">
          <div class="summary">
            <div class="user">Kunihiro Ishiguro</div>
            <div class="date"><a class="date" href="#message-1600629095.005100">2020-09-21 04:11:35 +0900</a></div>
          </div>
          <div class="description">@Kunihiro Ishiguro has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1600736594.005300">
        <div class="content">
          <div class="summary">
            <div class="user">小南靖雄</div>
            <div class="date"><a class="date" href="#message-1600736594.005300">2020-09-22 10:03:14 +0900</a></div>
          </div>
          <div class="description">@小南靖雄 has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1600753892.005400">
        <div class="content">
          <div class="summary">
            <div class="user">dfordivam</div>
            <div class="date"><a class="date" href="#message-1600753892.005400">2020-09-22 14:51:32 +0900</a></div>
          </div>
          <div class="description">どのようなプログラムですか？Jsaddleを使っていますか？確かにghcjs の開発は停止しているそうです。GHC8.8, や8.10 はないですね。</div>
        </div>
      </div>
      <div class="event" id="message-1600758537.005700">
        <div class="content">
          <div class="summary">
            <div class="user">nuoun</div>
            <div class="date"><a class="date" href="#message-1600758537.005700">2020-09-22 16:08:57 +0900</a></div>
          </div>
          <div class="description">@nuoun has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1600821584.000400">
        <div class="content">
          <div class="summary">
            <div class="user">kazu</div>
            <div class="date"><a class="date" href="#message-1600821584.000400">2020-09-23 09:39:44 +0900</a></div>
          </div>
          <div class="description">ByteString 0.11 では、内部のコンストラクタが PS から BS になり、offset フィールドがなくなります。これに伴い、foreign pointer は、必ずそのByteStringのバッファの先頭を指します。drop なんかで、バッファを共有する場合、foreign pointer がいろんなところを指すようになりますが、この方法でバッファはうまく GC できるんでしょうか？</div>
        </div>
      </div>
      <div class="event" id="message-1600826197.000500">
        <div class="content">
          <div class="summary">
            <div class="user">fumieval</div>
            <div class="date"><a class="date" href="#message-1600826197.000500">2020-09-23 10:56:37 +0900</a></div>
          </div>
          <div class="description"><pre>data ForeignPtr a = ForeignPtr Addr# ForeignPtrContents</pre><br/>の定義を見れば分かる通り、ForeignPtrには既にアドレスと実体を表す値(MutableByteArray#など)の二つが入っています。故にplusForeignPtrなどは安全に定義できます</div>
        </div>
      </div>
      <div class="event" id="message-1600829656.000700">
        <div class="content">
          <div class="summary">
            <div class="user">kazu</div>
            <div class="date"><a class="date" href="#message-1600829656.000700">2020-09-23 11:54:16 +0900</a></div>
          </div>
          <div class="description">なるほど！ ありがとうございました。</div>
        </div>
      </div>
      <div class="event" id="message-1600845249.001000">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1600845249.001000">2020-09-23 16:14:09 +0900</a></div>
          </div>
          <div class="description">@ has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1600944992.004400">
        <div class="content">
          <div class="summary">
            <div class="user">gksato</div>
            <div class="date"><a class="date" href="#message-1600944992.004400">2020-09-24 19:56:32 +0900</a></div>
          </div>
          <div class="description">これに関連してずっと気になっていたのですが，<br/><a href='https://haskell-jp.slack.com/archives/C5666B6BB/p1600826197000500?thread_ts=1600821584.000400&amp;cid=C5666B6BB'>https://haskell-jp.slack.com/archives/C5666B6BB/p1600826197000500?thread_ts=1600821584.000400&amp;cid=C5666B6BB</a><br/><pre>data Finalizers
  = NoFinalizers
  | CFinalizers (Weak# ())
  | HaskellFinalizers [IO ()]

data ForeignPtrContents
  = PlainForeignPtr !(IORef Finalizers)
  | MallocPtr      (MutableByteArray# RealWorld) !(IORef Finalizers)
  | PlainPtr       (MutableByteArray# RealWorld)

data ForeignPtr a = ForeignPtr Addr# ForeignPtrContents</pre><br/>この定義で，`ForeignPtr` が <code>IORef Finalizers</code> への参照を保持している理由，というか，この <code>Finalizer</code> という名前の由来がよくわからないんですよね………．GCされるときにただ捨てられるものを指して <code>Finalizer</code> とはどういうことなのか．</div>
        </div>
      </div>
      <div class="event" id="message-1600945536.004600">
        <div class="content">
          <div class="summary">
            <div class="user">gksato</div>
            <div class="date"><a class="date" href="#message-1600945536.004600">2020-09-24 20:05:36 +0900</a></div>
          </div>
          <div class="description">ただ捨てられる，ってのも変だな．“garbage collector (or compilers) should treat <code>ForeignPtrContents</code> specially” とか書いているのを見たことないので，ふっつーに扱われるんだろうな，と思っている，と言うのが正しい．</div>
        </div>
      </div>
      <div class="event" id="message-1600953249.007000">
        <div class="content">
          <div class="summary">
            <div class="user">mod_poppo</div>
            <div class="date"><a class="date" href="#message-1600953249.007000">2020-09-24 22:14:09 +0900</a></div>
          </div>
          <div class="description">最近追加されたコメントによると、ファイナライザの登録時に <code>mkWeak#</code> を使っているのがポイントのようですね <a href='https://gitlab.haskell.org/ghc/ghc/-/blob/a1f34d37b47826e86343e368a5c00f1a4b1f2bce/libraries/base/GHC/ForeignPtr.hs#L586'>https://gitlab.haskell.org/ghc/ghc/-/blob/a1f34d37b47826e86343e368a5c00f1a4b1f2bce/libraries/base/GHC/ForeignPtr.hs#L586</a></div>
        </div>
      </div>
      <div class="event" id="message-1600956771.007400">
        <div class="content">
          <div class="summary">
            <div class="user">maoe</div>
            <div class="date"><a class="date" href="#message-1600956771.007400">2020-09-24 23:12:51 +0900</a></div>
          </div>
          <div class="description">mkWeak#でweak pointerを作ってcapabilityごとに保持しているweak pointerのリストに追加します。GCは参照されていないweak pointerをリストアップしてscheduleFinalizersを呼び出し、リスト中のweak pointerのfinalizerを順次呼ぶという流れだと思います。Cのfinalizerはidle GCでも呼ばれていたような記憶があります。<br/>mkWeak#はrts/PrimOps.cmmのstg_mkWeakzhを、scheduleFinalizersはrts/Weak.cを見ると見つかります。</div>
        </div>
      </div>
      <div class="event" id="message-1600998780.007600">
        <div class="content">
          <div class="summary">
            <div class="user">kazu</div>
            <div class="date"><a class="date" href="#message-1600998780.007600">2020-09-25 10:53:00 +0900</a></div>
          </div>
          <div class="description">Finalizer とは、対象オブジェクトを捨てるために呼び出すコードのことですね。</div>
        </div>
      </div>
      <div class="event" id="message-1601021437.007800">
        <div class="content">
          <div class="summary">
            <div class="user">naohaq</div>
            <div class="date"><a class="date" href="#message-1601021437.007800">2020-09-25 17:10:37 +0900</a></div>
          </div>
          <div class="description">対象オブジェクトが何らかの(メモリ以外の)資源、例えばファイルハンドルを扱うものだった場合、GC でそのオブジェクトが捨てられるときにはファイルを閉じる必要があります。そのような処理をするのが finalizer です。</div>
        </div>
      </div>
      <div class="event" id="message-1601137541.012300">
        <div class="content">
          <div class="summary">
            <div class="user">gksato</div>
            <div class="date"><a class="date" href="#message-1601137541.012300">2020-09-27 01:25:41 +0900</a></div>
          </div>
          <div class="description">そのようなものがFinalizerだと思っていたので，たかが <code>IORef</code> に入っている <code>IO ()</code> くらいのものをfinalizerと呼ぶのか，とずっと疑問だったのですが，あれユーザランドで勝手に弄る前提のものではなかったのですね！　まずそこにびっくりしていました．exportされてるから，てっきり <code>atomicModifyIORef</code> あたりでユーザが勝手に弄って良いものかと・・・．</div>
        </div>
      </div>
      <div class="event" id="message-1601302226.014500">
        <div class="content">
          <div class="summary">
            <div class="user">gksato</div>
            <div class="date"><a class="date" href="#message-1601302226.014500">2020-09-28 23:10:26 +0900</a></div>
          </div>
          <div class="description"><code>mkWeak</code> あたりやっと読んできました。 <code>Weak</code> ってFinalizerをつけて作れるんですね。</div>
        </div>
      </div>
      <div class="event" id="message-1601302327.016300">
        <div class="content">
          <div class="summary">
            <div class="user">gksato</div>
            <div class="date"><a class="date" href="#message-1601302327.016300">2020-09-28 23:12:07 +0900</a></div>
          </div>
          <div class="description">（というか型の機能が型自体になくて作成時にimplicitに付けるっていうのが面白い発想だなと思いました）</div>
        </div>
      </div>
      <div class="event" id="message-1601452112.016600">
        <div class="content">
          <div class="summary">
            <div class="user">gen17</div>
            <div class="date"><a class="date" href="#message-1601452112.016600">2020-09-30 16:48:32 +0900</a></div>
          </div>
          <div class="description">@gen17 has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1601519786.016800">
        <div class="content">
          <div class="summary">
            <div class="user">agehara_hiroshi</div>
            <div class="date"><a class="date" href="#message-1601519786.016800">2020-10-01 11:36:26 +0900</a></div>
          </div>
          <div class="description">@agehara_hiroshi has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1601552292.017500">
        <div class="content">
          <div class="summary">
            <div class="user">mds_boy</div>
            <div class="date"><a class="date" href="#message-1601552292.017500">2020-10-01 20:38:12 +0900</a></div>
          </div>
          <div class="description">@mds_boy has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1601689316.017800">
        <div class="content">
          <div class="summary">
            <div class="user">Toshinori Takahashi</div>
            <div class="date"><a class="date" href="#message-1601689316.017800">2020-10-03 10:41:56 +0900</a></div>
          </div>
          <div class="description">@Toshinori Takahashi has joined the channel</div>
        </div>
      </div>
      <div class="event" id="message-1601795529.020200">
        <div class="content">
          <div class="summary">
            <div class="user">たけのこ</div>
            <div class="date"><a class="date" href="#message-1601795529.020200">2020-10-04 16:12:09 +0900</a></div>
          </div>
          <div class="description">たすけてください༼;´༎ຶ ༎ຶ༽<br/><br/><pre>class MonadIO m =&gt; MyClass m a | a -&gt; m where
  foo :: a -&gt; String
  bar :: a -&gt; m ()
</pre><br/>というクラスを作ったとき<br/><br/><pre>instance HasLogFunc e =&gt; MyClass (RIO e) MyData
</pre><br/>とかすると関数従属あるのにeが定まらなくてエラーになってしまいます。<br/>Hasパターンを維持したままこのようなことするにはどうしたらいいですか？</div>
        </div>
      </div>
      <div class="event" id="message-1601797091.020300">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1601797091.020300">2020-10-04 16:38:11 +0900</a></div>
          </div>
          <div class="description">何がしたいのかよく分かってないので、想定解ではないかもしれませんが、単純には <code>MyClass</code> の関数従属消せばいいのではないでしょうか？</div>
        </div>
      </div>
      <div class="event" id="message-1601802070.020500">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1601802070.020500">2020-10-04 18:01:10 +0900</a></div>
          </div>
          <div class="description">外してしまうと <code>foo</code> に <code>m</code> が現れないので一意に定まらなくなってしまうような</div>
        </div>
      </div>
      <div class="event" id="message-1601802578.020700">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1601802578.020700">2020-10-04 18:09:38 +0900</a></div>
          </div>
          <div class="description">どちらにしてももう少し詳しいモチベーションが知りたいですね。</div>
        </div>
      </div>
      <div class="event" id="message-1601804159.020900">
        <div class="content">
          <div class="summary">
            <div class="user">fumieval</div>
            <div class="date"><a class="date" href="#message-1601804159.020900">2020-10-04 18:35:59 +0900</a></div>
          </div>
          <div class="description">関数従属性が逆になっているのでは？MonadState s m | m -&gt; sのように、普通はモナドからパラメータを決めるのが典型的な方法です</div>
        </div>
      </div>
      <div class="event" id="message-1601806455.021300">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1601806455.021300">2020-10-04 19:14:15 +0900</a></div>
          </div>
          <div class="description">なるほど、foo の定義が問題なんですね。気づきませんでした。従属逆にしても、foo の定義で引っかかる気がするので、何れにしろこういうインスタンスを作るなら <code>MyClass</code> の従属性と foo の定義がおかしいので見直しが必要な気がしますね</div>
        </div>
      </div>
      <div class="event" id="message-1601815660.032700">
        <div class="content">
          <div class="summary">
            <div class="user">たけのこ</div>
            <div class="date"><a class="date" href="#message-1601815660.032700">2020-10-04 21:47:40 +0900</a></div>
          </div>
          <div class="description"><br/>モチベーションは今botを作っていてさまざまなbotの機能を`Bot`クラスのインスタンスで実装しようとしてます。<br/><br/><pre>lass MonadIO io =&gt; Bot io b | b -&gt; io where
  name :: b -&gt; String
  reply :: b -&gt; String -&gt; io (Maybe String)

instance HasLogFunc env =&gt; Bot (RIO env) MarkovChain

instance HasLogFunc env =&gt; Bot (RIO env) Shiritori
</pre><br/>こんな雰囲気のかんじです。<br/><br/>なのでモナドが定まってもbが定まってほしくないので関数従属の向きはこのままがいいです༼;´༎ຶ ༎ຶ༽</div>
        </div>
      </div>
      <div class="event" id="message-1601818402.033600">
        <div class="content">
          <div class="summary">
            <div class="user">fumieval</div>
            <div class="date"><a class="date" href="#message-1601818402.033600">2020-10-04 22:33:22 +0900</a></div>
          </div>
          <div class="description">どうやらデータによってenvに必要な制約が変わりうるというのが要点のようですね。だとすれば、型族を使ってこんな感じに表現できます<br/><pre>{-# LANGUAGE TypeFamilies #-}

import RIO
import Data.Kind
class Bot b where
  type Dep b env :: Constraint
  name :: b -&gt; String
  reply :: Dep b env =&gt; b -&gt; String -&gt; RIO env (Maybe String)

data MarkovChain

instance Bot MarkovChain where
  type Dep MarkovChain a = HasLogFunc a

data Shiritori

instance Bot Shiritori where
  type Dep Shiritori a = HasLogFunc a</pre></div>
        </div>
      </div>
      <div class="event" id="message-1601877734.036400">
        <div class="content">
          <div class="summary">
            <div class="user">たけのこ</div>
            <div class="date"><a class="date" href="#message-1601877734.036400">2020-10-05 15:02:14 +0900</a></div>
          </div>
          <div class="description">わあーなるほど<br/>ありがとございます:person_in_lotus_position:<br/>RIOではなくてIOを使う場合のインスタンスも書きたいのですがどうすればいいんですか？༼;´༎ຶ ༎ຶ༽</div>
        </div>
      </div>
      <div class="event" id="message-1601886012.036600">
        <div class="content">
          <div class="summary">
            <div class="user">fumieval</div>
            <div class="date"><a class="date" href="#message-1601886012.036600">2020-10-05 17:20:12 +0900</a></div>
          </div>
          <div class="description">型族type Run b :: Type → Typeをさらに追加し、type Run Shiritori = IOのようにすることも可能ですが、インスタンスによってメソッドの型が変わると型クラスの旨味がなくなるので、type Dep Foo a = ()のようにしてRIOに統一するのをおすすめします</div>
        </div>
      </div>
      <div class="event" id="message-1601915624.043200">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1601915624.043200">2020-10-06 01:33:44 +0900</a></div>
          </div>
          <div class="description">MonadFailが付いた型を付いてない型に変換する方法はありますか?<br/>何故やりたいのかと言うと、<br/>[Network.AWS.S3.StreamingUpload](<https://hackage.haskell.org/package/amazonka-s3-streaming-1.1.0.0/docs/Network-AWS-S3-StreamingUpload.html>)<br/>の <code>streamUpload</code> を使いたいのですが、<br/><br/><pre>-- | 自前のYesod環境下を前提としてAwsオペレーションを実行する
runYesodAws :: Yesod App =&gt; AWS.AWS a -&gt; HandlerFor App a
runYesodAws x = do
  site@App{appLogger, appAwsEnv} &lt;- getYesod
  -- ログ定義にAppの定義が必要なためApp自身に予め入れることは出来ない
  let awsLogger :: AWS.Logger
      awsLogger level builder
        = messageLoggerSource site appLogger defaultLoc "amazonka" (toYesodLogLevel level) (toLogStr builder)
  runResourceT $ AWS.runAWS (appAwsEnv &amp; AWS.envLogger .~ awsLogger) $ x

-- | amazonkaのログレベルをYesodのログレベルに変換する
toYesodLogLevel :: AWS.LogLevel -&gt; LogLevel
toYesodLogLevel <http://AWS.Info|AWS.Info>  = LevelInfo
toYesodLogLevel AWS.Error = LevelError
toYesodLogLevel AWS.Debug = LevelDebug
toYesodLogLevel AWS.Trace = LevelOther "Trace"</pre><br/>で変換する先の、<br/>[Yesod.Core.Handler](<https://www.stackage.org/haddock/lts-16.17/yesod-core-1.6.18.4/Yesod-Core-Handler.html#t:HandlerFor>)<br/>が <code>MonadFail</code> のインスタンスを定義していないので動かせなくて困っています。<br/>この関数はそれぞれのハンドラーで動いて例外が発生してもYesodのランタイムによってただのサーバー内部エラーとなるため、<br/>単に <code>fail = error</code> となるだけで良いのですが、<br/>変換する方法が全く分からなくて困っています。<br/><br/><code>liftIO</code> してIOで実行してHandlerForに移せば良いのではないか?なども考えてみたのですが、<br/>型自体は変わらないので無理でした。<br/><br/><pre>import           Control.Monad.Fail
import           Control.Monad.Trans.AWS        (AWST')

instance MonadFail (AWST' AWS.Env (ResourceT IO)) where
  fail = error</pre><br/>してやればとりあえず動くようなのですが、<br/>孤立インスタンスはなるべく定義したくありません。<br/>汎用的に使われているMonadFailを剥がせないなんて言うことはないと思うので、<br/>私の調べ方が悪いのだと思うのですが、<br/>方法がわかりませんでした…</div>
        </div>
      </div>
      <div class="event" id="message-1601919690.043400">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1601919690.043400">2020-10-06 02:41:30 +0900</a></div>
          </div>
          <div class="description">冷静に考えてみると <code>MonadFail</code> のインスタンスが無くて困ってるのは<br/><code>AWST' Env (ResourceT IO)</code> の方でしたね</div>
        </div>
      </div>
      <div class="event" id="message-1601921785.043600">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1601921785.043600">2020-10-06 03:16:25 +0900</a></div>
          </div>
          <div class="description">amazonka-s3-streamingの実行ファイル最新のGHCだと動かないんですね…</div>
        </div>
      </div>
      <div class="event" id="message-1601924692.043800">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1601924692.043800">2020-10-06 04:04:52 +0900</a></div>
          </div>
          <div class="description">よく考えてみると剥がせないのが当然な気もしてきた</div>
        </div>
      </div>
      <div class="event" id="message-1601935017.044500">
        <div class="content">
          <div class="summary">
            <div class="user">igrep</div>
            <div class="date"><a class="date" href="#message-1601935017.044500">2020-10-06 06:56:57 +0900</a></div>
          </div>
          <div class="description">その場での解決方法はまだ思いつきませんが諸悪の根源は <code>streamUpload</code> が <code>Either</code> を返すにもかかわらず <code>MonadFail</code>を要求している点であると思うので、そこはissueとして報告したいですね.... <code>Left</code> に <code>SomeExcpetion</code> があるんだから、そいつが担うこともできるでしょうに。 :cold_sweat:</div>
        </div>
      </div>
      <div class="event" id="message-1601935072.044700">
        <div class="content">
          <div class="summary">
            <div class="user"></div>
            <div class="date"><a class="date" href="#message-1601935072.044700">2020-10-06 06:57:52 +0900</a></div>
          </div>
          <div class="description">作者も痛みとして思っているようですね…<br/>とりあえずは孤立インスタンスとして凌ぐことにしようと思います</div>
        </div>
      </div>
    </div>
    <div class="ui pagination menu">
      <a href="../../html/C5666B6BB/89.html" class="item">Previous</a>
      <a href="../../" class="item">Top</a>
      <a href="../../html/C5666B6BB/91.html" class="item">Next</a>
    </div>
  </div>
</body>
</html>
