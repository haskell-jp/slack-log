[
    {
        "ts": "1721621462.260059",
        "text": "モナドでの `&lt;-`  の挙動について質問させてください。\n\nState s モナドを例にとります。\n```newtype State s a = State { runState :: s -&gt; (a,s) }\n\ninstance Monad (State s) where\n    return a = State $ \\s -&gt; (a, s)\n\n    (State h) &gt;&gt;= f = State $ \\s -&gt;\n        let\n            (a, newState) = h s\n            (State g) = f a\n        in\n            g newState\n\npop = State $ (\\(a:s) -&gt; (a,s))```\n上記の定義に対して以下のようなプログラムを実行します。\n```steps :: State [Int] Int\nsteps = do\n    a &lt;- pop\n    return a\n\nf = runState steps [1..5]```\n結果は以下の通りです。(hugs)\n```Main&gt; :set +t\nMain&gt; :l b.hs\nMain&gt; f\n(1,[2,3,4,5]) :: (Int,[Int])```\n動作自体は理解できたのですが、`a &lt;- pop` により値 (Int) が束縛される理由がわかりません。\n\nMaybe モナドで考えて `a &lt;- Just a` の場合は `Just` が外れて `a` が取り出されている。と理解しやすいです。\nまた、`(a, s) &lt;- pop` であった場合は `Monad (State s)` の定義と矛盾するような気がするので、違うのかと考えています。\n\nモナド値 State s `a` の場合、`a` の位置にあるものが `&lt;-` により取り出される。\nのだと思いますが、そういうものと考えてしまって良いものでしょうか ?",
        "type": "message",
        "user": "U04MBBNV5QB"
    },
    {
        "ts": "1721634349.478479",
        "text": "結論から言うと「モナド値 State s `a` の場合、`a` の位置にあるものが `&lt;-` により取り出される。」という認識で問題ないです。\n\n件の `do` 記法による定義を脱糖すると\n`steps = pop &gt;&gt;= \\a -&gt; return a`\nとなります。\nで、 `State` の `&gt;&gt;=` の定義を見ると、右辺に渡した関数 `f` 、この場合 `\\a -&gt; return a` の引数として渡しているのは、左辺にある `State h` というパターンマッチで取り出された `h` の結果 `(a, newState)` の `a` なのでタプルの一つ目の要素 `a` です。\nこれを `pop` に当てはめると\n`pop = State $ (\\(a:s) -&gt; (a,s))`\nという定義なので、結果である `(a,s)` の `a` が `&lt;-` によって束縛される、という説明でよいでしょうか？",
        "type": "message",
        "user": "U4LGTMTMK"
    },
    {
        "ts": "1721637299.916519",
        "text": "<@U4LGTMTMK>\n理屈から言えば、そーなんだろうな。と漠然とは考えられたのですが、Maybe モナドのように値が単独で存在せず、タプルの中の値になってしまっていたので、なんでこんな風に動作するんだろう\nと、考えてしまいました。\n\nタプルの中の値であっても、`a &lt;-` により、束縛されている値が取得できる。という認識が間違っていなくて安心しました。\n\n丁寧に解説までしていただき、ありがとうございました。",
        "type": "message",
        "user": "U04MBBNV5QB"
    },
    {
        "ts": "1721808030.021179",
        "text": "すでに分かっていたら余計なお世話かもしれませんが、\nまず一回Stateを使わずにタプルの2つ目で現在の状態を返すように書いてみて、それをStateを使ったものに書き換えると私はしっくり理解できました。",
        "type": "message",
        "user": "U57CUMWQ6"
    },
    {
        "ts": "1721814198.882379",
        "text": "`a &lt;-` と書くから「取り出している」と感じてしまうけれど、実際には `\\a -&gt;` なので一個の値を受け付ける関数が生成されているわけで、「後半部分が値を一個ぶんだけ受け取れるように取り計らってくれる（のがモナド）」という感じな気がしています。",
        "type": "message",
        "user": "UF8SE896V"
    }
]